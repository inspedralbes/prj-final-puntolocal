<template>
    <div>
        <!-- Botón Retroceder (GoBack) visible solo cuando showPopup es falso -->
        <div @click="goBack" class="text-xl text-gray-700 cursor-pointer" id="retrocederBtn">
            <svg width="1.5em" height="1.5em" viewBox="0 0 1024 1024" class="icon" xmlns="http://www.w3.org/2000/svg"
                fill="#000000">
                <g id="SVGRepo_iconCarrier">
                    <path fill="#000000" d="M224 480h640a32 32 0 110 64H224a32 32 0 010-64z"></path>
                    <path fill="#000000"
                        d="M237.248 512l265.408 265.344a32 32 0 01-45.312 45.312l-288-288a32 32 0 010-45.312l288-288a32 32 0 1145.312 45.312L237.248 512z">
                    </path>
                </g>
            </svg>
        </div>

        <!-- Buscador -->
        <div id="divBuscador">
            <input v-model="codigoPostal" @keyup.enter="buscarPorCodigoPostal" placeholder="Código Postal" />
            <button @click="buscarPorCodigoPostal" id="buscar" type="button">
                <img src="../assets/lupa-white.svg" alt="Lupa" />
            </button>
        </div>

        <!-- Contenedor del mapa visible siempre -->
        <div ref="mapContainer" class="map-container"></div>

        <!-- Botón GetLocation visible solo cuando showPopup es falso -->
        <div v-if="!showPopup">
            <button @click="getLocation" id="btnLocation">
                <img src="../assets/location.svg" alt="Location">
            </button>
        </div>

        <!-- Componente InfoMapa visible solo cuando showPopup es verdadero -->
        <InfoMapa v-if="showPopup" :info="puebloSeleccionado" @cerrarPopup="cerrarPopup" id="infoMapa" />
    </div>
</template>

<script setup>
import { onMounted, ref } from 'vue';
import 'ol/ol.css';
import { Map, View } from 'ol';
import TileLayer from 'ol/layer/Tile';
import OSM from 'ol/source/OSM';
import { fromLonLat } from 'ol/proj';
import VectorLayer from 'ol/layer/Vector';
import VectorSource from 'ol/source/Vector';
import Cluster from 'ol/source/Cluster'; // Importa Cluster
import Feature from 'ol/Feature';
import Point from 'ol/geom/Point';
import Style from 'ol/style/Style';
import { Icon, Fill, Stroke, Text, Circle as CircleStyle } from "ol/style";
import Select from 'ol/interaction/Select';
import { click } from 'ol/events/condition';
import { defaults as defaultControls } from 'ol/control';

const map = ref(null);
const router = useRouter();
const location = ref(null);
const codigoPostal = ref("");
const showPopup = ref(false);
const mapContainer = ref(null);
const puebloSeleccionado = ref({});
const vectorSource = ref(new VectorSource());
const { $communicationManager } = useNuxtApp();
const API_URL = "https://nominatim.openstreetmap.org/search";

// Fuente para los clústeres
const clusterSource = new Cluster({
    distance: 30,
    source: vectorSource.value
});

const clusterLayer = new VectorLayer({
    source: clusterSource,
    style: function (feature) {
        const features = feature.get('features'); // Obtenemos los puntos dentro del clúster
        const size = features.length; // Número de puntos en el clúster

        if (size === 1) {
            const marker = features[0]; // Solo hay un marcador
            return marker.getStyle(); // Devolvemos el estilo original del marcador
        }

        return new Style({
            image: new CircleStyle({
                radius: 15, // Radio del círculo
                fill: new Fill({
                    color: '#276BF2' // Color de fondo del círculo
                }),
                stroke: new Stroke({
                    color: 'white', // Color del borde del círculo
                    width: 2 // Grosor del borde
                })
            }),
            text: new Text({
                text: size.toString(), // Número de puntos en el clúster
                fill: new Fill({ color: 'white' }),
                // stroke: new Stroke({ color: 'black', width: 2 }),
                font: 'bold 13px Lato'
            })
        });
    }
});

onMounted(async () => {
    await nextTick();
    
    map.value = new Map({
        target: mapContainer.value,
        layers: [
            new TileLayer({ source: new OSM() }),
            clusterLayer
        ],
        view: new View({
            center: fromLonLat([2.15899, 41.38879]),
            zoom: 10
        }),
        controls: defaultControls({ zoom: false })
    });

    await agregarMarcadoresDesdeResponse();

    const selectClick = new Select({
        condition: click,
    });

    map.value.addInteraction(selectClick);

    selectClick.on('select', (e) => {
        const selected = e.selected[0];

        if (selected) {
            const features = selected.get('features');

            if (features && features.length > 1) {
                selectClick.getFeatures().clear();
                return; // No hacer nada si es un cluster con más de un marcador
            }

            const selectedFeature = features ? features[0] : selected;

            if (selectedFeature) {
                const id = selectedFeature.get('id');
                const name = selectedFeature.get('name');
                const lonLat = selectedFeature.getGeometry().getCoordinates();
                const lon = lonLat[0];
                const lat = lonLat[1];
                const puntaje = selectedFeature.get('puntaje_medio');
                const horario = selectedFeature.get('horario');
                const calle_num = selectedFeature.get('calle_num');
                const telefon = selectedFeature.get('phone');
                const imagen = selectedFeature.get('imagen');

                puebloSeleccionado.value = { id, name, lat, lon, puntaje_medio: puntaje, horario, calle_num, telefon, imagen };
                showPopup.value = puebloSeleccionado.value.id !== undefined;

                if (selectedFeature) {
                    selected.setStyle(
                        new Style({
                            image: new Icon({
                                src: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI3IiBoZWlnaHQ9IjE0OCIgdmlld0JveD0iMCAwIDEyNyAxNDgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxnIGZpbHRlcj0idXJsKCNmaWx0ZXIwX2RfOV8zOSkiPgo8cGF0aCBkPSJNMTIzIDU5LjVDMTIzIDkyLjM2MDkgOTUgMTIzLjUgNjMuNSAxMzkuNUMzMSAxMjMgNCA5Mi4zNjA5IDQgNTkuNUM0IDI2LjYzOTEgMzAuNjM5MSAwIDYzLjUgMEM5Ni4zNjA5IDAgMTIzIDI2LjYzOTEgMTIzIDU5LjVaIiBmaWxsPSIjMjc2QkYyIi8+CjxjaXJjbGUgY3g9IjYzLjUiIGN5PSI1OS41IiByPSIyOC41IiBmaWxsPSJ3aGl0ZSIvPgo8L2c+CjxkZWZzPgo8ZmlsdGVyIGlkPSJmaWx0ZXIwX2RfOV8zOSIgeD0iMCIgeT0iMCIgd2lkdGg9IjEyNyIgaGVpZ2h0PSIxNDcuNSIgZmlsdGVyVW5pdHM9InVzZXJTcGFjZU9uVXNlIiBjb2xvci1pbnRlcnBvbGF0aW9uLWZpbHRlcnM9InNSR0IiPgo8ZmVGbG9vZCBmbG9vZC1vcGFjaXR5PSIwIiByZXN1bHQ9IkJhY2tncm91bmRJbWFnZUZpeCIvPgo8ZmVDb2xvck1hdHJpeCBpbj0iU291cmNlQWxwaGEiIHR5cGU9Im1hdHJpeCIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAxMjcgMCIgcmVzdWx0PSJoYXJkQWxwaGEiLz4KPGZlT2Zmc2V0IGR5PSI0Ii8+CjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjIiLz4KPGZlQ29tcG9zaXRlIGluMj0iaGFyZEFscGhhIiBvcGVyYXRvcj0ib3V0Ii8+CjxmZUNvbG9yTWF0cml4IHR5cGU9Im1hdHJpeCIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwLjI1IDAiLz4KPGZlQmxlbmQgbW9kZT0ibm9ybWFsIiBpbjI9IkJhY2tncm91bmRJbWFnZUZpeCIgcmVzdWx0PSJlZmZlY3QxX2Ryb3BTaGFkb3dfOV8zOSIvPgo8ZmVCbGVuZCBtb2RlPSJub3JtYWwiIGluPSJTb3VyY2VHcmFwaGljIiBpbjI9ImVmZmVjdDFfZHJvcFNoYWRvd185XzM5IiByZXN1bHQ9InNoYXBlIi8+CjwvZmlsdGVyPgo8L2RlZnM+Cjwvc3ZnPgo=',
                                scale: 0.25
                            })
                        })
                    );
                }
            }
        }
    });

    map.value.on('click', (event) => {
        const clickedFeature = map.value.forEachFeatureAtPixel(event.pixel, (feature) => feature);

        if (!clickedFeature) {
            cerrarPopup();
        }
    });
});

const goBack = () => {
    router.back();
};

const agregarMarcadoresDesdeResponse = async () => {
    try {
        const categoria_icon = ref();
        const response = await $communicationManager.getLocations();

        response.forEach((comercio) => {
            if (!isNaN(comercio.latitude) && !isNaN(comercio.longitude)) {
                let horarioParseado = {};

                if (comercio.horario && typeof comercio.horario === 'string') {
                    try {
                        horarioParseado = JSON.parse(comercio.horario);
                    } catch (e) {
                        console.error('Error al parsear el horario:', e);
                    }
                }

                const marker = new Feature({
                    geometry: new Point(fromLonLat([comercio.longitude, comercio.latitude])),
                    id: comercio.id,
                    name: comercio.nombre,
                    puntaje_medio: comercio.puntaje_medio,
                    horario: horarioParseado,
                    phone: comercio.phone,
                    calle_num: comercio.calle_num,
                    categoria_id: comercio.categoria_id,
                    imagen: comercio.imagen
                });

                switch (comercio.categoria_id) {
                    case 1:
                        categoria_icon.value = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI3IiBoZWlnaHQ9IjE0OCIgdmlld0JveD0iMCAwIDEyNyAxNDgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxnIGZpbHRlcj0idXJsKCNmaWx0ZXIwX2RfNl8xMDgpIj4KPHBhdGggZD0iTTEyMyA1OS41QzEyMyA5Mi4zNjA5IDk1IDEyMy41IDYzLjUgMTM5LjVDMzEgMTIzIDQgOTIuMzYwOSA0IDU5LjVDNCAyNi42MzkxIDMwLjYzOTEgMCA2My41IDBDOTYuMzYwOSAwIDEyMyAyNi42MzkxIDEyMyA1OS41WiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iNjMuNSIgY3k9IjU5LjUiIHI9IjQ3LjUiIGZpbGw9IiMyNzZCRjIiLz4KPHBhdGggZD0iTTEwNS4wMjUgNDguNzk1NEw5Ni4zNzc5IDU0LjI4OThDOTUuNzUwNiA1NC42Njk2IDk1LjAwOTIgNTQuODEwOCA5NC4yODc3IDU0LjY4NzlDOTMuNTY2MSA1NC41NjQ5IDkyLjkxMiA1NC4xODU5IDkyLjQ0MzUgNTMuNjE5M0w4OC4xNDgzIDQ4LjE4MThWODkuNDA5MkM4OC4xNDY4IDkwLjEyNDYgODcuODY0MyA5MC44MTAyIDg3LjM2MjUgOTEuMzE2Qzg2Ljg2MDcgOTEuODIxOCA4Ni4xODA1IDkyLjEwNjYgODUuNDcwOSA5Mi4xMDgxSDQxLjU2MTJDNDAuODUxNiA5Mi4xMDY2IDQwLjE3MTQgOTEuODIxOCAzOS42Njk3IDkxLjMxNkMzOS4xNjc5IDkwLjgxMDIgMzguODg1MyA5MC4xMjQ2IDM4Ljg4MzggODkuNDA5MlY0OC4xMzYzTDM0LjU0OTIgNTMuNjE5M0MzNC4wODA5IDU0LjE4NDUgMzMuNDI3OSA1NC41NjI1IDMyLjcwNzYgNTQuNjg1NUMzMS45ODczIDU0LjgwODQgMzEuMjQ3MiA1NC42NjgxIDMwLjYyMDUgNTQuMjg5OEwyMS45NjgyIDQ4Ljc5NTRDMjEuNjc5IDQ4LjYyNzkgMjEuNDMxOCA0OC4zOTU4IDIxLjI0NTUgNDguMTE2OUMyMS4wNTkzIDQ3LjgzODEgMjAuOTM5IDQ3LjUxOTkgMjAuODkzOCA0Ny4xODY4QzIwLjg0ODYgNDYuODUzNyAyMC44Nzk4IDQ2LjUxNDcgMjAuOTg0OSA0Ni4xOTU2QzIxLjA5MDEgNDUuODc2NiAyMS4yNjY0IDQ1LjU4NjEgMjEuNTAwMyA0NS4zNDY1TDM0LjE1NDYgMzEuMTg3NEMzNS42NDIgMjkuNTIwNyAzNy40NjA1IDI4LjE4OCAzOS40OTIgMjcuMjc1N0M0MS41MjM1IDI2LjM2MzQgNDMuNzIyNiAyNS44OTE5IDQ1Ljk0NjYgMjUuODkxOUg1MS4yMTY5QzUyLjI0ODUgMjguMzE4MSA1My45NjM4IDMwLjM4NTggNTYuMTUgMzEuODM4OUM1OC4zMzYyIDMzLjI5MTkgNjAuODk3NCAzNC4wNjY1IDYzLjUxNjEgMzQuMDY2NUM2Ni4xMzQ4IDM0LjA2NjUgNjguNjk1OSAzMy4yOTE5IDcwLjg4MjEgMzEuODM4OUM3My4wNjg0IDMwLjM4NTggNzQuNzgzNiAyOC4zMTgxIDc1LjgxNTMgMjUuODkxOUg4MS4wNzk5QzgzLjMwNTIgMjUuODkyNiA4NS41MDU0IDI2LjM2NDkgODcuNTM3OCAyNy4yNzgxQzg5LjU3MDMgMjguMTkxNCA5MS4zODk1IDI5LjUyNTIgOTIuODc3NSAzMS4xOTMxTDEwNS41MDQgNDUuMzQwOEMxMDUuNzM3IDQ1LjU4MTggMTA1LjkxMyA0NS44NzM0IDEwNi4wMTcgNDYuMTkzM0MxMDYuMTIxIDQ2LjUxMzMgMTA2LjE1MSA0Ni44NTMxIDEwNi4xMDUgNDcuMTg2N0MxMDYuMDU5IDQ3LjUyMDIgMTA1LjkzNyA0Ny44Mzg2IDEwNS43NSA0OC4xMTc1QzEwNS41NjMgNDguMzk2NCAxMDUuMzE1IDQ4LjYyODMgMTA1LjAyNSA0OC43OTU0WiIgZmlsbD0id2hpdGUiLz4KPC9nPgo8ZGVmcz4KPGZpbHRlciBpZD0iZmlsdGVyMF9kXzZfMTA4IiB4PSIwIiB5PSIwIiB3aWR0aD0iMTI3IiBoZWlnaHQ9IjE0Ny41IiBmaWx0ZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIGNvbG9yLWludGVycG9sYXRpb24tZmlsdGVycz0ic1JHQiI+CjxmZUZsb29kIGZsb29kLW9wYWNpdHk9IjAiIHJlc3VsdD0iQmFja2dyb3VuZEltYWdlRml4Ii8+CjxmZUNvbG9yTWF0cml4IGluPSJTb3VyY2VBbHBoYSIgdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDEyNyAwIiByZXN1bHQ9ImhhcmRBbHBoYSIvPgo8ZmVPZmZzZXQgZHk9IjQiLz4KPGZlR2F1c3NpYW5CbHVyIHN0ZERldmlhdGlvbj0iMiIvPgo8ZmVDb21wb3NpdGUgaW4yPSJoYXJkQWxwaGEiIG9wZXJhdG9yPSJvdXQiLz4KPGZlQ29sb3JNYXRyaXggdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuMjUgMCIvPgo8ZmVCbGVuZCBtb2RlPSJub3JtYWwiIGluMj0iQmFja2dyb3VuZEltYWdlRml4IiByZXN1bHQ9ImVmZmVjdDFfZHJvcFNoYWRvd182XzEwOCIvPgo8ZmVCbGVuZCBtb2RlPSJub3JtYWwiIGluPSJTb3VyY2VHcmFwaGljIiBpbjI9ImVmZmVjdDFfZHJvcFNoYWRvd182XzEwOCIgcmVzdWx0PSJzaGFwZSIvPgo8L2ZpbHRlcj4KPC9kZWZzPgo8L3N2Zz4K';
                        break;
                    case 2:
                        categoria_icon.value = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI3IiBoZWlnaHQ9IjE0OCIgdmlld0JveD0iMCAwIDEyNyAxNDgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxnIGZpbHRlcj0idXJsKCNmaWx0ZXIwX2RfNl8xMDgpIj4KPHBhdGggZD0iTTEyMyA1OS41QzEyMyA5Mi4zNjA5IDk1IDEyMy41IDYzLjUgMTM5LjVDMzEgMTIzIDQgOTIuMzYwOSA0IDU5LjVDNCAyNi42MzkxIDMwLjYzOTEgMCA2My41IDBDOTYuMzYwOSAwIDEyMyAyNi42MzkxIDEyMyA1OS41WiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iNjMuNSIgY3k9IjU5LjUiIHI9IjQ3LjUiIGZpbGw9IiMyNzZCRjIiLz4KPHBhdGggZD0iTTc5LjEgMjFINDYuOUM0My4wODgxIDIxIDQwIDI0LjE5MiA0MCAyOC4xMjVWODkuODc1QzQwIDkzLjgxMTIgNDMuMDkxMiA5NyA0Ni45IDk3SDc5LjFDODIuOTExOSA5NyA4NiA5My44MTEyIDg2IDg5Ljg3NVYyOC4xMjVDODYgMjQuMTg4OCA4Mi45MDg4IDIxIDc5LjEgMjFaTTYzIDkyLjI1QzYwLjQ2MzkgOTIuMjQ2OCA1OC40MDkyIDkwLjEyNTIgNTguNDA5MiA4Ny41MDYzQzU4LjQwOTIgODQuODg3NSA2MC40NjY5IDgyLjc2MjcgNjMuMDAzMSA4Mi43NjI3QzY1LjUzOTIgODIuNzYyNyA2Ny41OTY5IDg0Ljg4NzUgNjcuNTk2OSA4Ny41MDYzQzY3LjU5NjkgODguODE3MyA2Ny4wODE3IDkwLjAwMTcgNjYuMjUwNyA5MC44NTk4QzY1LjQxOTYgOTEuNzE4IDY0LjI2OTYgOTIuMjUgNjMgOTIuMjVaIiBmaWxsPSJ3aGl0ZSIvPgo8L2c+CjxkZWZzPgo8ZmlsdGVyIGlkPSJmaWx0ZXIwX2RfNl8xMDgiIHg9IjAiIHk9IjAiIHdpZHRoPSIxMjciIGhlaWdodD0iMTQ3LjUiIGZpbHRlclVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgY29sb3ItaW50ZXJwb2xhdGlvbi1maWx0ZXJzPSJzUkdCIj4KPGZlRmxvb2QgZmxvb2Qtb3BhY2l0eT0iMCIgcmVzdWx0PSJCYWNrZ3JvdW5kSW1hZ2VGaXgiLz4KPGZlQ29sb3JNYXRyaXggaW49IlNvdXJjZUFscGhhIiB0eXBlPSJtYXRyaXgiIHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMTI3IDAiIHJlc3VsdD0iaGFyZEFscGhhIi8+CjxmZU9mZnNldCBkeT0iNCIvPgo8ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPSIyIi8+CjxmZUNvbXBvc2l0ZSBpbjI9ImhhcmRBbHBoYSIgb3BlcmF0b3I9Im91dCIvPgo8ZmVDb2xvck1hdHJpeCB0eXBlPSJtYXRyaXgiIHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMC4yNSAwIi8+CjxmZUJsZW5kIG1vZGU9Im5vcm1hbCIgaW4yPSJCYWNrZ3JvdW5kSW1hZ2VGaXgiIHJlc3VsdD0iZWZmZWN0MV9kcm9wU2hhZG93XzZfMTA4Ii8+CjxmZUJsZW5kIG1vZGU9Im5vcm1hbCIgaW49IlNvdXJjZUdyYXBoaWMiIGluMj0iZWZmZWN0MV9kcm9wU2hhZG93XzZfMTA4IiByZXN1bHQ9InNoYXBlIi8+CjwvZmlsdGVyPgo8L2RlZnM+Cjwvc3ZnPgo=';
                        break;
                    case 3:
                        categoria_icon.value = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI3IiBoZWlnaHQ9IjE0OCIgdmlld0JveD0iMCAwIDEyNyAxNDgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxnIGZpbHRlcj0idXJsKCNmaWx0ZXIwX2RfNl8xMDgpIj4KPHBhdGggZD0iTTEyMyA1OS41QzEyMyA5Mi4zNjA5IDk1IDEyMy41IDYzLjUgMTM5LjVDMzEgMTIzIDQgOTIuMzYwOSA0IDU5LjVDNCAyNi42MzkxIDMwLjYzOTEgMCA2My41IDBDOTYuMzYwOSAwIDEyMyAyNi42MzkxIDEyMyA1OS41WiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iNjMuNSIgY3k9IjU5LjUiIHI9IjQ3LjUiIGZpbGw9IiMyNzZCRjIiLz4KPHBhdGggZD0iTTkwLjY5NDkgNDcuMjE1NkwxMDMuMTA1IDU4LjY3NjVDMTA0LjYwNSA2MC4wODExIDEwNC4xNzcgNjEuMTYzOCAxMDIuMTQzIDYxLjE2MzhIOTIuODM0NlY5MS4xMDgyQzkyLjgzNDYgOTMuMTYzMSA5MS4xMjI4IDk1IDg5LjA4OTMgOTVINzIuOTMzN1Y3NC4wMjU4QzcyLjkzMzcgNzEuOTcwOSA3MS4xMTU4IDcwLjEzNCA2OS4wODIyIDcwLjEzNEg1OC45MTc4QzU2Ljg4NDIgNzAuMTM0IDU1LjA2NjMgNzEuOTcwOSA1NS4wNjYzIDc0LjAyNThWOTVIMzguOTEwN0MzNi44NzcyIDk1IDM1LjA1OTMgOTMuMTYzMSAzNS4wNTkzIDkxLjEwODJWNjEuMTYzOEgyNS44NTY5QzIzLjgyMzMgNjEuMTYzOCAyMy4zOTU0IDYwLjA4MTEgMjQuODk0OSA1OC42NzY1TDYxLjE2MzYgMjUuMzgwMUM2Mi42NjMxIDIzLjk3NTUgNjUuMjMwOCAyMy45NzU1IDY2LjgzMyAyNS4zODAxTDc1LjA2OTkgMzIuODM4NVYyNi44OTE4Qzc1LjA2OTkgMjQuODM2OSA3Ni44ODc4IDIzIDc4LjkyMTQgMjNIODYuOTQ2MUM4OC45Nzk3IDIzIDkwLjY5MTUgMjQuODM2OSA5MC42OTE1IDI2Ljg5MThMOTAuNjk0OSA0Ny4yMTU2WiIgZmlsbD0id2hpdGUiLz4KPC9nPgo8ZGVmcz4KPGZpbHRlciBpZD0iZmlsdGVyMF9kXzZfMTA4IiB4PSIwIiB5PSIwIiB3aWR0aD0iMTI3IiBoZWlnaHQ9IjE0Ny41IiBmaWx0ZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIGNvbG9yLWludGVycG9sYXRpb24tZmlsdGVycz0ic1JHQiI+CjxmZUZsb29kIGZsb29kLW9wYWNpdHk9IjAiIHJlc3VsdD0iQmFja2dyb3VuZEltYWdlRml4Ii8+CjxmZUNvbG9yTWF0cml4IGluPSJTb3VyY2VBbHBoYSIgdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDEyNyAwIiByZXN1bHQ9ImhhcmRBbHBoYSIvPgo8ZmVPZmZzZXQgZHk9IjQiLz4KPGZlR2F1c3NpYW5CbHVyIHN0ZERldmlhdGlvbj0iMiIvPgo8ZmVDb21wb3NpdGUgaW4yPSJoYXJkQWxwaGEiIG9wZXJhdG9yPSJvdXQiLz4KPGZlQ29sb3JNYXRyaXggdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuMjUgMCIvPgo8ZmVCbGVuZCBtb2RlPSJub3JtYWwiIGluMj0iQmFja2dyb3VuZEltYWdlRml4IiByZXN1bHQ9ImVmZmVjdDFfZHJvcFNoYWRvd182XzEwOCIvPgo8ZmVCbGVuZCBtb2RlPSJub3JtYWwiIGluPSJTb3VyY2VHcmFwaGljIiBpbjI9ImVmZmVjdDFfZHJvcFNoYWRvd182XzEwOCIgcmVzdWx0PSJzaGFwZSIvPgo8L2ZpbHRlcj4KPC9kZWZzPgo8L3N2Zz4K';
                        break;
                    case 4:
                        categoria_icon.value = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI3IiBoZWlnaHQ9IjE0OCIgdmlld0JveD0iMCAwIDEyNyAxNDgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxnIGZpbHRlcj0idXJsKCNmaWx0ZXIwX2RfNl8xMDgpIj4KPHBhdGggZD0iTTEyMyA1OS41QzEyMyA5Mi4zNjA5IDk1IDEyMy41IDYzLjUgMTM5LjVDMzEgMTIzIDQgOTIuMzYwOSA0IDU5LjVDNCAyNi42MzkxIDMwLjYzOTEgMCA2My41IDBDOTYuMzYwOSAwIDEyMyAyNi42MzkxIDEyMyA1OS41WiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iNjMuNSIgY3k9IjU5LjUiIHI9IjQ3LjUiIGZpbGw9IiMyNzZCRjIiLz4KPHBhdGggZD0iTTQwLjc2MiA4OC42MjMyQzQwLjc2MiA4OS45MzEyIDQxLjc2NjQgOTAuOTk1MiA0My4wMDEyIDkwLjk5NTJINDguNjc0OUM0OS45MDk0IDkwLjk5NTIgNTAuOTE0IDg5LjkzMTIgNTAuOTE0IDg4LjYyMzJWODMuMzEwM0g0MC43NjJWODguNjIzMloiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik0zNi4yNjM4IDc4LjI1MzVDMzYuMjYzOCA3OS4xMjI0IDM2LjYwNTggNzkuOTA1NSAzNy4xNTMxIDgwLjQ2NDVDMzcuNjc0NiA4MC45OTcgMzguMzgyNiA4MS4zMjYgMzkuMTY0MiA4MS4zMjZINTIuNTExNEM1My4yOTI4IDgxLjMyNiA1NC4wMDA2IDgwLjk5NyA1NC41MjIzIDgwLjQ2NDhDNTUuMDcgNzkuOTA1NiA1NS40MTIgNzkuMTIyNSA1NS40MTIgNzguMjUzNUw1OS4xMzIgNDQuMjAyM0wzNC44ODA5IDY1LjU5NDNMMzYuMjYzOCA3OC4yNTM1WiIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTU3Ljc3NTQgMjdIMzMuOTAwM0MzMi4yOTg1IDI3IDMxIDI4LjM3NTcgMzEgMzAuMDcyNUwzNC4zNjEgNjAuODM1TDU5Ljc2MzEgMzguNDI4MUw2MC42NzU5IDMwLjA3MjVDNjAuNjc1OSAyOC4zNzU3IDU5LjM3NzUgMjcgNTcuNzc1NCAyN1oiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik04Ni44NzgyIDU0LjQ0NDZDODYuODc4MiA1Mi43OTQ0IDg1LjYxMDYgNTEuNDUxOCA4NC4wNTI4IDUxLjQ1MThINzcuMDgwNEM3NS41MjI1IDUxLjQ1MTggNzQuMjU1IDUyLjc5NDQgNzQuMjU1IDU0LjQ0NDZWNjEuMjA5OEg4Ni44NzgyVjU0LjQ0NDZaIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNOTAuNjU5OSA2My4yODkzQzkwLjMzMDEgNjMuMjQxNCA4OS45OTQyIDYzLjIxNDUgODkuNjUyMiA2My4yMTQ1SDg4Ljc3MDhINzIuMzYyNUg3MS40ODExQzcxLjEzOTEgNjMuMjE0NSA3MC44MDMyIDYzLjI0MTQgNzAuNDczNCA2My4yODkzQzY2Ljg5MjQgNjMuODA5NyA2NC4xMzM1IDY3LjA2MTYgNjQuMTMzNSA3MC45OTc4Vjg1LjIxNjhDNjQuMTMzNSA4OS41MTU0IDY3LjQyMzEgOTMgNzEuNDgxMSA5M0g4OS42NTI1QzkzLjcxMDMgOTMgOTcgODkuNTE1NCA5NyA4NS4yMTY4VjcwLjk5NzhDOTcgNjcuMDYxNiA5NC4yNDA4IDYzLjgxIDkwLjY1OTkgNjMuMjg5M1pNODAuNTY2NiA4NC4yNTI0Qzc3LjM2MjggODQuMjUyNCA3NC43NjU3IDgxLjUwMTIgNzQuNzY1NyA3OC4xMDc0Qzc0Ljc2NTcgNzQuNzEzNiA3Ny4zNjI5IDcxLjk2MjMgODAuNTY2NiA3MS45NjIzQzgzLjc3MDcgNzEuOTYyMyA4Ni4zNjc4IDc0LjcxMzUgODYuMzY3OCA3OC4xMDc0Qzg2LjM2NzggODEuNTAxMiA4My43NzA1IDg0LjI1MjQgODAuNTY2NiA4NC4yNTI0WiIgZmlsbD0id2hpdGUiLz4KPC9nPgo8ZGVmcz4KPGZpbHRlciBpZD0iZmlsdGVyMF9kXzZfMTA4IiB4PSIwIiB5PSIwIiB3aWR0aD0iMTI3IiBoZWlnaHQ9IjE0Ny41IiBmaWx0ZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIGNvbG9yLWludGVycG9sYXRpb24tZmlsdGVycz0ic1JHQiI+CjxmZUZsb29kIGZsb29kLW9wYWNpdHk9IjAiIHJlc3VsdD0iQmFja2dyb3VuZEltYWdlRml4Ii8+CjxmZUNvbG9yTWF0cml4IGluPSJTb3VyY2VBbHBoYSIgdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDEyNyAwIiByZXN1bHQ9ImhhcmRBbHBoYSIvPgo8ZmVPZmZzZXQgZHk9IjQiLz4KPGZlR2F1c3NpYW5CbHVyIHN0ZERldmlhdGlvbj0iMiIvPgo8ZmVDb21wb3NpdGUgaW4yPSJoYXJkQWxwaGEiIG9wZXJhdG9yPSJvdXQiLz4KPGZlQ29sb3JNYXRyaXggdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuMjUgMCIvPgo8ZmVCbGVuZCBtb2RlPSJub3JtYWwiIGluMj0iQmFja2dyb3VuZEltYWdlRml4IiByZXN1bHQ9ImVmZmVjdDFfZHJvcFNoYWRvd182XzEwOCIvPgo8ZmVCbGVuZCBtb2RlPSJub3JtYWwiIGluPSJTb3VyY2VHcmFwaGljIiBpbjI9ImVmZmVjdDFfZHJvcFNoYWRvd182XzEwOCIgcmVzdWx0PSJzaGFwZSIvPgo8L2ZpbHRlcj4KPC9kZWZzPgo8L3N2Zz4K';
                        break;
                    case 5:
                        categoria_icon.value = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI3IiBoZWlnaHQ9IjE0OCIgdmlld0JveD0iMCAwIDEyNyAxNDgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxnIGZpbHRlcj0idXJsKCNmaWx0ZXIwX2RfNl8xMDgpIj4KPHBhdGggZD0iTTEyMyA1OS41QzEyMyA5Mi4zNjA5IDk1IDEyMy41IDYzLjUgMTM5LjVDMzEgMTIzIDQgOTIuMzYwOSA0IDU5LjVDNCAyNi42MzkxIDMwLjYzOTEgMCA2My41IDBDOTYuMzYwOSAwIDEyMyAyNi42MzkxIDEyMyA1OS41WiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iNjMuNSIgY3k9IjU5LjUiIHI9IjQ3LjUiIGZpbGw9IiMyNzZCRjIiLz4KPHBhdGggZD0iTTYzLjUgMzQuNDY4OEM0Ni41MzQ0IDM0LjQ2ODggMzIuOTA2MiA0OC4wOTY5IDMyLjkwNjIgNjUuMDYyNUMzMi45MDYyIDgyLjAyODEgNDYuNTM0NCA5NS42NTYyIDYzLjUgOTUuNjU2MkM4MC40NjU2IDk1LjY1NjIgOTQuMDkzOCA4Mi4wMjgxIDk0LjA5MzggNjUuMDYyNUM5NC4wOTM4IDQ4LjA5NjkgODAuNDY1NiAzNC40Njg4IDYzLjUgMzQuNDY4OFpNNzEuODQzOCA1OS41QzcxLjg0MzggNTcuODMxMiA3Mi45NTYyIDU2LjcxODggNzQuNjI1IDU2LjcxODhDNzYuMjkzOCA1Ni43MTg4IDc3LjQwNjIgNTcuODMxMiA3Ny40MDYyIDU5LjVWNjIuMjgxMkM3Ny40MDYyIDYzLjk1IDc2LjI5MzggNjUuMDYyNSA3NC42MjUgNjUuMDYyNUM3Mi45NTYyIDY1LjA2MjUgNzEuODQzOCA2My45NSA3MS44NDM4IDYyLjI4MTJWNTkuNVpNNDkuNTkzOCA1OS41QzQ5LjU5MzggNTcuODMxMiA1MC43MDYyIDU2LjcxODggNTIuMzc1IDU2LjcxODhDNTQuMDQzOCA1Ni43MTg4IDU1LjE1NjIgNTcuODMxMiA1NS4xNTYyIDU5LjVWNjIuMjgxMkM1NS4xNTYyIDYzLjk1IDU0LjA0MzggNjUuMDYyNSA1Mi4zNzUgNjUuMDYyNUM1MC43MDYyIDY1LjA2MjUgNDkuNTkzOCA2My45NSA0OS41OTM4IDYyLjI4MTJWNTkuNVpNNjMuNSA5MC4wOTM4QzU0LjA0MzcgOTAuMDkzOCA0NS45NzgxIDg0LjUzMTIgNDUuOTc4MSA3Ny41NzgxQzQ1Ljk3ODEgNzEuNDU5NCA1Mi4zNzUgNjYuMTc1IDYwLjcxODggNjUuMzQwNlY3MC42MjVDNjAuNzE4OCA3Mi4yOTM4IDYxLjgzMTIgNzMuNDA2MiA2My41IDczLjQwNjJDNjUuMTY4OCA3My40MDYyIDY2LjI4MTIgNzIuMjkzOCA2Ni4yODEyIDcwLjYyNVY2NS4zNDA2Qzc0LjYyNSA2Ni4xNzUgODEuMDIxOSA3MS40NTk0IDgxLjAyMTkgNzcuNTc4MUM4MS4wMjE5IDg0LjUzMTIgNzIuOTU2MyA5MC4wOTM4IDYzLjUgOTAuMDkzOFoiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik01MC4xNSAzMS40MDk0QzQ3LjY0NjkgMjkuNzQwNiA0NC41ODc1IDI4LjkwNjIgNDEuMjUgMjguOTA2MkMzMi4wNzE5IDI4LjkwNjIgMjQuNTYyNSAzNi40MTU2IDI0LjU2MjUgNDUuNTkzOEMyNC41NjI1IDQ5LjQ4NzUgMjUuOTUzMSA1My4zODEzIDI4LjQ1NjMgNTYuMTYyNUMzMS4yMzc1IDQ1LjAzNzUgMzkuNTgxMiAzNS44NTk0IDUwLjE1IDMxLjQwOTRaIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNODUuNzUgMjguOTA2MkM4Mi40MTI1IDI4LjkwNjIgNzkuMzUzMSAyOS43NDA2IDc2Ljg1IDMxLjQwOTRDODcuNDE4NyAzNS41ODEzIDk1Ljc2MjUgNDQuNzU5NCA5OC41NDM3IDU2LjE2MjVDMTAxLjA0NyA1My4xMDMxIDEwMi40MzcgNDkuNDg3NSAxMDIuNDM3IDQ1LjU5MzhDMTAyLjQzNyAzNi40MTU2IDk0LjkyODEgMjguOTA2MiA4NS43NSAyOC45MDYyWiIgZmlsbD0id2hpdGUiLz4KPC9nPgo8ZGVmcz4KPGZpbHRlciBpZD0iZmlsdGVyMF9kXzZfMTA4IiB4PSIwIiB5PSIwIiB3aWR0aD0iMTI3IiBoZWlnaHQ9IjE0Ny41IiBmaWx0ZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIGNvbG9yLWludGVycG9sYXRpb24tZmlsdGVycz0ic1JHQiI+CjxmZUZsb29kIGZsb29kLW9wYWNpdHk9IjAiIHJlc3VsdD0iQmFja2dyb3VuZEltYWdlRml4Ii8+CjxmZUNvbG9yTWF0cml4IGluPSJTb3VyY2VBbHBoYSIgdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDEyNyAwIiByZXN1bHQ9ImhhcmRBbHBoYSIvPgo8ZmVPZmZzZXQgZHk9IjQiLz4KPGZlR2F1c3NpYW5CbHVyIHN0ZERldmlhdGlvbj0iMiIvPgo8ZmVDb21wb3NpdGUgaW4yPSJoYXJkQWxwaGEiIG9wZXJhdG9yPSJvdXQiLz4KPGZlQ29sb3JNYXRyaXggdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuMjUgMCIvPgo8ZmVCbGVuZCBtb2RlPSJub3JtYWwiIGluMj0iQmFja2dyb3VuZEltYWdlRml4IiByZXN1bHQ9ImVmZmVjdDFfZHJvcFNoYWRvd182XzEwOCIvPgo8ZmVCbGVuZCBtb2RlPSJub3JtYWwiIGluPSJTb3VyY2VHcmFwaGljIiBpbjI9ImVmZmVjdDFfZHJvcFNoYWRvd182XzEwOCIgcmVzdWx0PSJzaGFwZSIvPgo8L2ZpbHRlcj4KPC9kZWZzPgo8L3N2Zz4K';
                        break;
                    case 6:
                        categoria_icon.value = "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI3IiBoZWlnaHQ9IjE0OCIgdmlld0JveD0iMCAwIDEyNyAxNDgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxnIGZpbHRlcj0idXJsKCNmaWx0ZXIwX2RfNl8xMDgpIj4KPHBhdGggZD0iTTEyMyA1OS41QzEyMyA5Mi4zNjA5IDk1IDEyMy41IDYzLjUgMTM5LjVDMzEgMTIzIDQgOTIuMzYwOSA0IDU5LjVDNCAyNi42MzkxIDMwLjYzOTEgMCA2My41IDBDOTYuMzYwOSAwIDEyMyAyNi42MzkxIDEyMyA1OS41WiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iNjMuNSIgY3k9IjU5LjUiIHI9IjQ3LjUiIGZpbGw9IiMyNzZCRjIiLz4KPHBhdGggZD0iTTk4LjcxNjcgMzIuNjQxM0M5OC43MTY3IDMyLjY0MTMgODkuNDUxNCA0MS45MDA1IDg3LjAxNzMgNDQuMzY0OEM4Ni41NDc0IDQ0Ljg0MDggODYuMDg0MSA0NC45OTIyIDg1LjQ1ODMgNDQuODk2MUM4NC42Mzk2IDQ0Ljc3MTEgODMuODE0MyA0NC42ODYgODIuOTkxNiA0NC41ODc2QzgwLjc0MDYgNDQuMzE5NSA3OC40ODg5IDQ0LjA1MzYgNzYuMTk2MyA0My43ODE2Qzc1LjgxMzggNDAuNTA5MSA3NS40MjUyIDM3LjMwMTMgNzUuMDg3OSAzNC4wODc5Qzc1LjA1NjQgMzMuNzg1NiA3NS4yNzE1IDMzLjM3MzIgNzUuNTAxNCAzMy4xNDA1Qzc4LjMwNDggMzAuMzAyNCA4Ni4xNDk0IDIyLjQ3ODggODcuMjk4NyAyMS4zMzI5Qzg0LjgwNjYgMjAuMTU2IDgwLjUzMDUgMTkuNjkyMiA3Ny4zNDQgMjAuMjEwMkM2NS4yOTE5IDIyLjE2ODcgNTcuOTMzMyAzNC4yMTc4IDYxLjc1MTEgNDUuNzc2N0M2MS45NjEyIDQ2LjQxMTggNjEuODI5NiA0Ni43ODI3IDYxLjM3NjMgNDcuMjM1NUM1MS4xNTg0IDU3LjQyNTYgNDAuOTU2MSA2Ny42MzAxIDMwLjc1MzIgNzcuODM0NUMzMC40MTI3IDc4LjE3NTEgMzAuMDcyNyA3OC41MiAyOS43Njk3IDc4Ljg5MkMyNi44NTk3IDgyLjQ3MDIgMjcuNjI4NiA4Ny44ODI2IDMxLjQxMzggOTAuNTExNkMzNC43NTUxIDkyLjgzMTcgMzguOTY0MyA5Mi40MTQzIDQxLjk0NjggODkuNDM0OEM1Mi4xOTI4IDc5LjE5NzcgNjIuNDMzOCA2OC45NTU2IDcyLjY2MTYgNTguNzAwOUM3My4xNjk2IDU4LjE5MTcgNzMuNTczMiA1OC4wMTgyIDc0LjMxNTEgNTguMjcwOEM3Ny43MzY1IDU5LjQzNjYgODEuMjM4NiA1OS41NzIxIDg0Ljc1NDYgNTguNzU5NUM5NS40NzE2IDU2LjI4NDEgMTAyLjAzMSA0NS42NDA3IDk5LjQzMTUgMzQuOTcwN0M5OS4yNTYzIDM0LjI1MTYgOTguOTk5MiAzMy41Mzk2IDk4LjcxNjcgMzIuNjQxM1oiIGZpbGw9IndoaXRlIi8+CjwvZz4KPGRlZnM+CjxmaWx0ZXIgaWQ9ImZpbHRlcjBfZF82XzEwOCIgeD0iMCIgeT0iMCIgd2lkdGg9IjEyNyIgaGVpZ2h0PSIxNDcuNSIgZmlsdGVyVW5pdHM9InVzZXJTcGFjZU9uVXNlIiBjb2xvci1pbnRlcnBvbGF0aW9uLWZpbHRlcnM9InNSR0IiPgo8ZmVGbG9vZCBmbG9vZC1vcGFjaXR5PSIwIiByZXN1bHQ9IkJhY2tncm91bmRJbWFnZUZpeCIvPgo8ZmVDb2xvck1hdHJpeCBpbj0iU291cmNlQWxwaGEiIHR5cGU9Im1hdHJpeCIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAxMjcgMCIgcmVzdWx0PSJoYXJkQWxwaGEiLz4KPGZlT2Zmc2V0IGR5PSI0Ii8+CjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjIiLz4KPGZlQ29tcG9zaXRlIGluMj0iaGFyZEFscGhhIiBvcGVyYXRvcj0ib3V0Ii8+CjxmZUNvbG9yTWF0cml4IHR5cGU9Im1hdHJpeCIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwLjI1IDAiLz4KPGZlQmxlbmQgbW9kZT0ibm9ybWFsIiBpbjI9IkJhY2tncm91bmRJbWFnZUZpeCIgcmVzdWx0PSJlZmZlY3QxX2Ryb3BTaGFkb3dfNl8xMDgiLz4KPGZlQmxlbmQgbW9kZT0ibm9ybWFsIiBpbj0iU291cmNlR3JhcGhpYyIgaW4yPSJlZmZlY3QxX2Ryb3BTaGFkb3dfNl8xMDgiIHJlc3VsdD0ic2hhcGUiLz4KPC9maWx0ZXI+CjwvZGVmcz4KPC9zdmc+Cg==";
                        break;
                    case 7:
                        categoria_icon.value = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI3IiBoZWlnaHQ9IjE0OCIgdmlld0JveD0iMCAwIDEyNyAxNDgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxnIGZpbHRlcj0idXJsKCNmaWx0ZXIwX2RfNl8xMDgpIj4KPHBhdGggZD0iTTEyMyA1OS41QzEyMyA5Mi4zNjA5IDk1IDEyMy41IDYzLjUgMTM5LjVDMzEgMTIzIDQgOTIuMzYwOSA0IDU5LjVDNCAyNi42MzkxIDMwLjYzOTEgMCA2My41IDBDOTYuMzYwOSAwIDEyMyAyNi42MzkxIDEyMyA1OS41WiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iNjMuNSIgY3k9IjU5LjUiIHI9IjQ3LjUiIGZpbGw9IiMyNzZCRjIiLz4KPHBhdGggZD0iTTM2LjI1IDg4LjM3NUgzMy45Mzc1QzMyLjcxMDkgODguMzc1IDMxLjUzNDUgODcuODg3NyAzMC42NjcxIDg3LjAyMDRDMjkuNzk5OCA4Ni4xNTMgMjkuMzEyNSA4NC45NzY2IDI5LjMxMjUgODMuNzVWMzUuMTg3NUMyOS4zMTI1IDMzLjk2MDkgMjkuNzk5OCAzMi43ODQ1IDMwLjY2NzEgMzEuOTE3MUMzMS41MzQ1IDMxLjA0OTggMzIuNzEwOSAzMC41NjI1IDMzLjkzNzUgMzAuNTYyNUgzNi4yNUMzNy40NzY2IDMwLjU2MjUgMzguNjUzIDMxLjA0OTggMzkuNTIwNCAzMS45MTcxQzQwLjM4NzcgMzIuNzg0NSA0MC44NzUgMzMuOTYwOSA0MC44NzUgMzUuMTg3NVY4My43NUM0MC44NzUgODQuOTc2NiA0MC4zODc3IDg2LjE1MyAzOS41MjA0IDg3LjAyMDRDMzguNjUzIDg3Ljg4NzcgMzcuNDc2NiA4OC4zNzUgMzYuMjUgODguMzc1WiIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTYxLjY4NzUgNDQuNDM3NUM2MS42ODc1IDQzLjIxMDkgNjEuMjAwMiA0Mi4wMzQ1IDYwLjMzMjkgNDEuMTY3MUM1OS40NjU1IDQwLjI5OTggNTguMjg5MSAzOS44MTI1IDU3LjA2MjUgMzkuODEyNUg0Ny44MTI1QzQ2LjU4NTkgMzkuODEyNSA0NS40MDk1IDQwLjI5OTggNDQuNTQyMSA0MS4xNjcxQzQzLjY3NDggNDIuMDM0NSA0My4xODc1IDQzLjIxMDkgNDMuMTg3NSA0NC40Mzc1VjQ4LjQ4NDRDNDMuMTg3NSA0OC42Mzc3IDQzLjI0ODQgNDguNzg0OCA0My4zNTY4IDQ4Ljg5MzJDNDMuNDY1MiA0OS4wMDE2IDQzLjYxMjMgNDkuMDYyNSA0My43NjU2IDQ5LjA2MjVINjEuMTA5NEM2MS4yNjI3IDQ5LjA2MjUgNjEuNDA5OCA0OS4wMDE2IDYxLjUxODIgNDguODkzMkM2MS42MjY2IDQ4Ljc4NDggNjEuNjg3NSA0OC42Mzc3IDYxLjY4NzUgNDguNDg0NFY0NC40Mzc1WiIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTQzLjE4NzUgODMuNzVDNDMuMTg3NSA4NC45NzY2IDQzLjY3NDggODYuMTUzIDQ0LjU0MjEgODcuMDIwNEM0NS40MDk1IDg3Ljg4NzcgNDYuNTg1OSA4OC4zNzUgNDcuODEyNSA4OC4zNzVINTcuMDYyNUM1OC4yODkxIDg4LjM3NSA1OS40NjU1IDg3Ljg4NzcgNjAuMzMyOSA4Ny4wMjA0QzYxLjIwMDIgODYuMTUzIDYxLjY4NzUgODQuOTc2NiA2MS42ODc1IDgzLjc1Vjc5LjQxNDFDNjEuNjg3NSA3OS4zMzc0IDYxLjY1NyA3OS4yNjM5IDYxLjYwMjggNzkuMjA5N0M2MS41NDg2IDc5LjE1NTUgNjEuNDc1MSA3OS4xMjUgNjEuMzk4NCA3OS4xMjVINDMuNDc2NkM0My4zOTk5IDc5LjEyNSA0My4zMjY0IDc5LjE1NTUgNDMuMjcyMiA3OS4yMDk3QzQzLjIxOCA3OS4yNjM5IDQzLjE4NzUgNzkuMzM3NCA0My4xODc1IDc5LjQxNDFWODMuNzVaIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNNjEuMzk4NCA1My42ODc1SDQzLjQ3NjZDNDMuMzE2OSA1My42ODc1IDQzLjE4NzUgNTMuODE2OSA0My4xODc1IDUzLjk3NjZWNzQuMjEwOUM0My4xODc1IDc0LjM3MDYgNDMuMzE2OSA3NC41IDQzLjQ3NjYgNzQuNUg2MS4zOTg0QzYxLjU1ODEgNzQuNSA2MS42ODc1IDc0LjM3MDYgNjEuNjg3NSA3NC4yMTA5VjUzLjk3NjZDNjEuNjg3NSA1My44MTY5IDYxLjU1ODEgNTMuNjg3NSA2MS4zOTg0IDUzLjY4NzVaIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNNzMuMjUgODguMzc1SDY4LjYyNUM2Ny4zOTg0IDg4LjM3NSA2Ni4yMjIgODcuODg3NyA2NS4zNTQ2IDg3LjAyMDRDNjQuNDg3MyA4Ni4xNTMgNjQgODQuOTc2NiA2NCA4My43NVYyOC4yNUM2NCAyNy4wMjM0IDY0LjQ4NzMgMjUuODQ3IDY1LjM1NDYgMjQuOTc5NkM2Ni4yMjIgMjQuMTEyMyA2Ny4zOTg0IDIzLjYyNSA2OC42MjUgMjMuNjI1SDczLjI1Qzc0LjQ3NjYgMjMuNjI1IDc1LjY1MyAyNC4xMTIzIDc2LjUyMDQgMjQuOTc5NkM3Ny4zODc3IDI1Ljg0NyA3Ny44NzUgMjcuMDIzNCA3Ny44NzUgMjguMjVWODMuNzVDNzcuODc1IDg0Ljk3NjYgNzcuMzg3NyA4Ni4xNTMgNzYuNTIwNCA4Ny4wMjA0Qzc1LjY1MyA4Ny44ODc3IDc0LjQ3NjYgODguMzc1IDczLjI1IDg4LjM3NVoiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik05OC42NzE2IDgzLjM4MTVMOTQuMDEzNCAzNC4yNDA4QzkzLjc5OTUgMzEuOTc4OSA5MS41NjUgMzAuMzM4NSA4OS4wMjI3IDMwLjU4MjdMODQuNDE5NCAzMS4wMTYzQzgxLjg3NzEgMzEuMjU3NyA3OS45ODk1IDMzLjI4NjkgODAuMjAzNCAzNS41NDg4TDg0Ljg2MTcgODQuNjg5NUM4NS4wNzU2IDg2Ljk1MTQgODcuMzEgODguNTkxOCA4OS44NTIzIDg4LjM0NzVMOTQuNDU1NiA4Ny45MTM5Qzk2Ljk5NzkgODcuNjcyNiA5OC44ODU1IDg1LjY0MzQgOTguNjcxNiA4My4zODE1WiIgZmlsbD0id2hpdGUiLz4KPC9nPgo8ZGVmcz4KPGZpbHRlciBpZD0iZmlsdGVyMF9kXzZfMTA4IiB4PSIwIiB5PSIwIiB3aWR0aD0iMTI3IiBoZWlnaHQ9IjE0Ny41IiBmaWx0ZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIGNvbG9yLWludGVycG9sYXRpb24tZmlsdGVycz0ic1JHQiI+CjxmZUZsb29kIGZsb29kLW9wYWNpdHk9IjAiIHJlc3VsdD0iQmFja2dyb3VuZEltYWdlRml4Ii8+CjxmZUNvbG9yTWF0cml4IGluPSJTb3VyY2VBbHBoYSIgdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDEyNyAwIiByZXN1bHQ9ImhhcmRBbHBoYSIvPgo8ZmVPZmZzZXQgZHk9IjQiLz4KPGZlR2F1c3NpYW5CbHVyIHN0ZERldmlhdGlvbj0iMiIvPgo8ZmVDb21wb3NpdGUgaW4yPSJoYXJkQWxwaGEiIG9wZXJhdG9yPSJvdXQiLz4KPGZlQ29sb3JNYXRyaXggdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuMjUgMCIvPgo8ZmVCbGVuZCBtb2RlPSJub3JtYWwiIGluMj0iQmFja2dyb3VuZEltYWdlRml4IiByZXN1bHQ9ImVmZmVjdDFfZHJvcFNoYWRvd182XzEwOCIvPgo8ZmVCbGVuZCBtb2RlPSJub3JtYWwiIGluPSJTb3VyY2VHcmFwaGljIiBpbjI9ImVmZmVjdDFfZHJvcFNoYWRvd182XzEwOCIgcmVzdWx0PSJzaGFwZSIvPgo8L2ZpbHRlcj4KPC9kZWZzPgo8L3N2Zz4K';
                        break;
                    case 8:
                        categoria_icon.value = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI3IiBoZWlnaHQ9IjE0OCIgdmlld0JveD0iMCAwIDEyNyAxNDgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxnIGZpbHRlcj0idXJsKCNmaWx0ZXIwX2RfNl8xMDgpIj4KPHBhdGggZD0iTTEyMyA1OS41QzEyMyA5Mi4zNjA5IDk1IDEyMy41IDYzLjUgMTM5LjVDMzEgMTIzIDQgOTIuMzYwOSA0IDU5LjVDNCAyNi42MzkxIDMwLjYzOTEgMCA2My41IDBDOTYuMzYwOSAwIDEyMyAyNi42MzkxIDEyMyA1OS41WiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iNjMuNSIgY3k9IjU5LjUiIHI9IjQ3LjUiIGZpbGw9IiMyNzZCRjIiLz4KPHBhdGggZD0iTTg4LjM0NzkgMjZIMzkuNjUzMkMzNC44ODIyIDI2IDMxIDI5Ljg4MjIgMzEgMzQuNjU0MlY4My4zNDM3QzMxIDg4LjExNjggMzQuODgxMSA5MiAzOS42NTMyIDkySDg4LjM0NzlDOTMuMTE4OSA5MiA5NyA4OC4xMTc4IDk3IDgzLjM0MzdWMzQuNjU0MkM5NyAyOS44ODIyIDkzLjExODkgMjYgODguMzQ3OSAyNlpNODQuMjg1NiA2NS43NjQ3SDcwLjc2MzZWNzkuMjg1Nkg1Ny4yNDQ3VjY1Ljc2NDdINDMuNzE4NVY1Mi4yMzUzSDU3LjI0NDdWMzguNzE0NEg3MC43NjM2VjUyLjIzNTNIODQuMjg1NlY2NS43NjQ3WiIgZmlsbD0id2hpdGUiLz4KPC9nPgo8ZGVmcz4KPGZpbHRlciBpZD0iZmlsdGVyMF9kXzZfMTA4IiB4PSIwIiB5PSIwIiB3aWR0aD0iMTI3IiBoZWlnaHQ9IjE0Ny41IiBmaWx0ZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIGNvbG9yLWludGVycG9sYXRpb24tZmlsdGVycz0ic1JHQiI+CjxmZUZsb29kIGZsb29kLW9wYWNpdHk9IjAiIHJlc3VsdD0iQmFja2dyb3VuZEltYWdlRml4Ii8+CjxmZUNvbG9yTWF0cml4IGluPSJTb3VyY2VBbHBoYSIgdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDEyNyAwIiByZXN1bHQ9ImhhcmRBbHBoYSIvPgo8ZmVPZmZzZXQgZHk9IjQiLz4KPGZlR2F1c3NpYW5CbHVyIHN0ZERldmlhdGlvbj0iMiIvPgo8ZmVDb21wb3NpdGUgaW4yPSJoYXJkQWxwaGEiIG9wZXJhdG9yPSJvdXQiLz4KPGZlQ29sb3JNYXRyaXggdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuMjUgMCIvPgo8ZmVCbGVuZCBtb2RlPSJub3JtYWwiIGluMj0iQmFja2dyb3VuZEltYWdlRml4IiByZXN1bHQ9ImVmZmVjdDFfZHJvcFNoYWRvd182XzEwOCIvPgo8ZmVCbGVuZCBtb2RlPSJub3JtYWwiIGluPSJTb3VyY2VHcmFwaGljIiBpbjI9ImVmZmVjdDFfZHJvcFNoYWRvd182XzEwOCIgcmVzdWx0PSJzaGFwZSIvPgo8L2ZpbHRlcj4KPC9kZWZzPgo8L3N2Zz4K';
                        break;
                    case 9:
                        categoria_icon.value = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI3IiBoZWlnaHQ9IjE0OCIgdmlld0JveD0iMCAwIDEyNyAxNDgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxnIGZpbHRlcj0idXJsKCNmaWx0ZXIwX2RfNl8xMDgpIj4KPHBhdGggZD0iTTEyMyA1OS41QzEyMyA5Mi4zNjA5IDk1IDEyMy41IDYzLjUgMTM5LjVDMzEgMTIzIDQgOTIuMzYwOSA0IDU5LjVDNCAyNi42MzkxIDMwLjYzOTEgMCA2My41IDBDOTYuMzYwOSAwIDEyMyAyNi42MzkxIDEyMyA1OS41WiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iNjMuNSIgY3k9IjU5LjUiIHI9IjQ3LjUiIGZpbGw9IiMyNzZCRjIiLz4KPHBhdGggZD0iTTEwNS4zNTYgNjYuNjU3NkMxMDYuOTkxIDY0LjQ3NTIgMTA4LjM1NiA1OC40NzQ3IDEwMy40NDUgNTUuNDczMUM5OC41MzM5IDUyLjQ3MTUgNzUuODkxNiA0Mi4zNzYyIDY4Ljc5NjYgMzguMDExMUM2MS43MDQxIDMzLjY0NTkgNTguNzAzOSAzNy4xOTM0IDU4LjcwMzkgNDEuMDE0QzU4LjcwMzkgNDQuODMzMSA1OC43MDM5IDQ2LjE5NjcgNTguNzAzOSA0Ny41NjE3QzU4LjcwMzkgNDguOTI0MSA1OS41MjAzIDUxLjEwNjYgNTMuNzkyNiA1MS4xMDY2QzQ4LjA2MjYgNTEuMTA2NiAzNy4xNTEgNTEuMTA2NiAzNC40MjExIDUxLjEwNjZDMjUuOTY2MyA1MS4xMDY2IDI2Ljc4MjcgNDUuNjUwNyAyMy43ODI1IDQ5LjE5ODNDMjAuNzgyMiA1Mi43NDQ1IDIyLjA1MzYgNjMuMTEyOCAyNC4wNTU1IDY2LjY1NzZIMTA1LjM1NloiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik0yMy45ODggNjguNzg5NkwyNC40MTk2IDczLjI5NjRINTAuNTE0Mkw1MS4xNTY1IDcxLjQ3OTJMNTguNzE5NCA3My4yOTY0SDEwNC45NTZDMTA1LjQ4MyA3MS41NjM4IDEwNS42MjYgNzAuMDc5MSAxMDUuNDQ0IDY4Ljc4OTZIMjMuOTg4WiIgZmlsbD0id2hpdGUiLz4KPC9nPgo8ZGVmcz4KPGZpbHRlciBpZD0iZmlsdGVyMF9kXzZfMTA4IiB4PSIwIiB5PSIwIiB3aWR0aD0iMTI3IiBoZWlnaHQ9IjE0Ny41IiBmaWx0ZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIGNvbG9yLWludGVycG9sYXRpb24tZmlsdGVycz0ic1JHQiI+CjxmZUZsb29kIGZsb29kLW9wYWNpdHk9IjAiIHJlc3VsdD0iQmFja2dyb3VuZEltYWdlRml4Ii8+CjxmZUNvbG9yTWF0cml4IGluPSJTb3VyY2VBbHBoYSIgdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDEyNyAwIiByZXN1bHQ9ImhhcmRBbHBoYSIvPgo8ZmVPZmZzZXQgZHk9IjQiLz4KPGZlR2F1c3NpYW5CbHVyIHN0ZERldmlhdGlvbj0iMiIvPgo8ZmVDb21wb3NpdGUgaW4yPSJoYXJkQWxwaGEiIG9wZXJhdG9yPSJvdXQiLz4KPGZlQ29sb3JNYXRyaXggdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuMjUgMCIvPgo8ZmVCbGVuZCBtb2RlPSJub3JtYWwiIGluMj0iQmFja2dyb3VuZEltYWdlRml4IiByZXN1bHQ9ImVmZmVjdDFfZHJvcFNoYWRvd182XzEwOCIvPgo8ZmVCbGVuZCBtb2RlPSJub3JtYWwiIGluPSJTb3VyY2VHcmFwaGljIiBpbjI9ImVmZmVjdDFfZHJvcFNoYWRvd182XzEwOCIgcmVzdWx0PSJzaGFwZSIvPgo8L2ZpbHRlcj4KPC9kZWZzPgo8L3N2Zz4K';
                        break;
                    case 10:
                        categoria_icon.value = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI3IiBoZWlnaHQ9IjE0OCIgdmlld0JveD0iMCAwIDEyNyAxNDgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxnIGZpbHRlcj0idXJsKCNmaWx0ZXIwX2RfNl8xMDgpIj4KPHBhdGggZD0iTTEyMyA1OS41QzEyMyA5Mi4zNjA5IDk1IDEyMy41IDYzLjUgMTM5LjVDMzEgMTIzIDQgOTIuMzYwOSA0IDU5LjVDNCAyNi42MzkxIDMwLjYzOTEgMCA2My41IDBDOTYuMzYwOSAwIDEyMyAyNi42MzkxIDEyMyA1OS41WiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iNjMuNSIgY3k9IjU5LjUiIHI9IjQ3LjUiIGZpbGw9IiMyNzZCRjIiLz4KPHBhdGggZD0iTTU5LjI0NCAxMDAuNDcxTDY0IDEwMUM2Mi44MzIyIDkxLjY1NTUgNTguNTUxIDgyLjk3NjYgNTEuODQ2OCA3Ni4zNjMyQzQ1LjE0MjYgNjkuNzQ5OCAzNi40MDYzIDY1LjU4NzIgMjcuMDQ2NyA2NC41NDY5TDIzIDY0LjFMMjMuMDg2MSA2NC44MDkzQzI0LjIzMDEgNzMuOTUxNSAyOC40MTk4IDgyLjQ0MiAzNC45Nzk2IDg4LjkxMTdDNDEuNTM5MyA5NS4zODE1IDUwLjA4NjkgOTkuNDUzNSA1OS4yNDQgMTAwLjQ3MVpNMTA0LjkxNCA2NC44MDkzTDEwNSA2NC4xTDEwMC45NTMgNjQuNTQ2OUM4MS42ODMzIDY2LjY5MTIgNjYuNDAyNiA4MS43NjY5IDY0IDEwMUw2OC43NTYgMTAwLjQ3MUM3Ny45MTMxIDk5LjQ1MzUgODYuNDYwNyA5NS4zODE1IDkzLjAyMDQgODguOTExN0M5OS41ODAyIDgyLjQ0MiAxMDMuNzcgNzMuOTUxNSAxMDQuOTE0IDY0LjgwOTNaTTg4Ljg1ODMgMzMuMzVDODcuNDk5IDMwLjk5NTkgODUuMjYwMyAyOS4yNzgxIDgyLjYzNDUgMjguNTc0NUM4MC4wMDg3IDI3Ljg3MSA3Ny4yMTEgMjguMjM5MyA3NC44NTY4IDI5LjU5ODVDNzQuNjAyNiAyOS43NDIgNzQuNDAxNyAyOS45MzA2IDc0LjE2OCAzMC4wOTQ2Qzc0LjE4ODUgMjkuODExNyA3NC4yNSAyOS41MzcgNzQuMjUgMjkuMjVDNzQuMjUgMjYuNTMxNSA3My4xNzAxIDIzLjkyNDQgNzEuMjQ3OCAyMi4wMDIyQzY5LjMyNTYgMjAuMDc5OSA2Ni43MTg1IDE5IDY0IDE5QzYxLjI4MTUgMTkgNTguNjc0NCAyMC4wNzk5IDU2Ljc1MjIgMjIuMDAyMkM1NC44Mjk5IDIzLjkyNDQgNTMuNzUgMjYuNTMxNSA1My43NSAyOS4yNUM1My43NSAyOS41MzcgNTMuODExNSAyOS44MTE3IDUzLjgzNjEgMzAuMDk0NkM1My42MDI0IDI5LjkzMDYgNTMuMzk3NCAyOS43NDIgNTMuMTQ3MyAyOS41OTg1QzUwLjc5NDMgMjguMjYwNyA0OC4wMDc3IDI3LjkwNzkgNDUuMzk1NiAyOC42MTcxQzQyLjc4MzUgMjkuMzI2MyA0MC41NTc5IDMxLjAzOTggMzkuMjA0NSAzMy4zODM5QzM3Ljg1MTEgMzUuNzI3OSAzNy40Nzk4IDM4LjUxMjEgMzguMTcxNyA0MS4xMjg5QzM4Ljg2MzUgNDMuNzQ1NyA0MC41NjIzIDQ1Ljk4MjYgNDIuODk3MyA0Ny4zNTE1QzQzLjE0NzQgNDcuNDk1IDQzLjQxMzkgNDcuNTgxMSA0My42NjgxIDQ3LjdDNDMuNDEzOSA0Ny44MTg5IDQzLjE0NzQgNDcuOTA1IDQyLjg5NzMgNDguMDQ4NUM0MC41NjIzIDQ5LjQxNzQgMzguODYzNSA1MS42NTQzIDM4LjE3MTcgNTQuMjcxMUMzNy40Nzk4IDU2Ljg4NzkgMzcuODUxMSA1OS42NzIxIDM5LjIwNDUgNjIuMDE2MUM0MC41NTc5IDY0LjM2MDIgNDIuNzgzNSA2Ni4wNzM3IDQ1LjM5NTYgNjYuNzgyOUM0OC4wMDc3IDY3LjQ5MjEgNTAuNzk0MyA2Ny4xMzkzIDUzLjE0NzMgNjUuODAxNUM1My40MDE1IDY1LjY1OCA1My42MDI0IDY1LjQ2OTQgNTMuODM2MSA2NS4zMDU0QzUzLjgxMTUgNjUuNTg4MyA1My43NSA2NS44NjMgNTMuNzUgNjYuMTVDNTMuNzUgNjguODY4NSA1NC44Mjk5IDcxLjQ3NTYgNTYuNzUyMiA3My4zOTc4QzU4LjY3NDQgNzUuMzIwMSA2MS4yODE1IDc2LjQgNjQgNzYuNEM2Ni43MTg1IDc2LjQgNjkuMzI1NiA3NS4zMjAxIDcxLjI0NzggNzMuMzk3OEM3My4xNzAxIDcxLjQ3NTYgNzQuMjUgNjguODY4NSA3NC4yNSA2Ni4xNUM3NC4yNSA2NS44NjMgNzQuMTg4NSA2NS41ODgzIDc0LjE2MzkgNjUuMzA1NEM3NC4zOTc2IDY1LjQ2OTQgNzQuNTk4NSA2NS42NTggNzQuODUyNyA2NS44MDE1Qzc3LjIwNTcgNjcuMTM5MyA3OS45OTIzIDY3LjQ5MjEgODIuNjA0NCA2Ni43ODI5Qzg1LjIxNjUgNjYuMDczNyA4Ny40NDIxIDY0LjM2MDIgODguNzk1NSA2Mi4wMTYxQzkwLjE0ODkgNTkuNjcyMSA5MC41MjAyIDU2Ljg4NzkgODkuODI4MyA1NC4yNzExQzg5LjEzNjUgNTEuNjU0MyA4Ny40Mzc3IDQ5LjQxNzQgODUuMTAyNyA0OC4wNDg1Qzg0Ljg1MjYgNDcuOTA1IDg0LjU4NjEgNDcuODE4OSA4NC4zMzE5IDQ3LjdDODQuNTkwMiA0Ny41ODExIDg0Ljg1MjYgNDcuNDk1IDg1LjEwMjcgNDcuMzUxNUM4Ni4yNjg3IDQ2LjY3ODggODcuMjkwOCA0NS43ODMgODguMTEwNiA0NC43MTUzQzg4LjkzMDMgNDMuNjQ3NSA4OS41MzE4IDQyLjQyODggODkuODgwNSA0MS4xMjg2QzkwLjIyOTMgMzkuODI4NCA5MC4zMTg1IDM4LjQ3MjMgOTAuMTQzMSAzNy4xMzc2Qzg5Ljk2NzcgMzUuODAzIDg5LjUzMTEgMzQuNTE1OSA4OC44NTgzIDMzLjM1Wk02NCA2MEM2MC43Mzc4IDYwIDU3LjYwOTMgNTguNzA0MSA1NS4zMDI2IDU2LjM5NzRDNTIuOTk1OSA1NC4wOTA3IDUxLjcgNTAuOTYyMiA1MS43IDQ3LjdDNTEuNyA0NC40Mzc4IDUyLjk5NTkgNDEuMzA5MyA1NS4zMDI2IDM5LjAwMjZDNTcuNjA5MyAzNi42OTU5IDYwLjczNzggMzUuNCA2NCAzNS40QzY3LjI2MjIgMzUuNCA3MC4zOTA3IDM2LjY5NTkgNzIuNjk3NCAzOS4wMDI2Qzc1LjAwNDEgNDEuMzA5MyA3Ni4zIDQ0LjQzNzggNzYuMyA0Ny43Qzc2LjMgNTAuOTYyMiA3NS4wMDQxIDU0LjA5MDcgNzIuNjk3NCA1Ni4zOTc0QzcwLjM5MDcgNTguNzA0MSA2Ny4yNjIyIDYwIDY0IDYwWiIgZmlsbD0id2hpdGUiLz4KPC9nPgo8ZGVmcz4KPGZpbHRlciBpZD0iZmlsdGVyMF9kXzZfMTA4IiB4PSIwIiB5PSIwIiB3aWR0aD0iMTI3IiBoZWlnaHQ9IjE0Ny41IiBmaWx0ZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIGNvbG9yLWludGVycG9sYXRpb24tZmlsdGVycz0ic1JHQiI+CjxmZUZsb29kIGZsb29kLW9wYWNpdHk9IjAiIHJlc3VsdD0iQmFja2dyb3VuZEltYWdlRml4Ii8+CjxmZUNvbG9yTWF0cml4IGluPSJTb3VyY2VBbHBoYSIgdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDEyNyAwIiByZXN1bHQ9ImhhcmRBbHBoYSIvPgo8ZmVPZmZzZXQgZHk9IjQiLz4KPGZlR2F1c3NpYW5CbHVyIHN0ZERldmlhdGlvbj0iMiIvPgo8ZmVDb21wb3NpdGUgaW4yPSJoYXJkQWxwaGEiIG9wZXJhdG9yPSJvdXQiLz4KPGZlQ29sb3JNYXRyaXggdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuMjUgMCIvPgo8ZmVCbGVuZCBtb2RlPSJub3JtYWwiIGluMj0iQmFja2dyb3VuZEltYWdlRml4IiByZXN1bHQ9ImVmZmVjdDFfZHJvcFNoYWRvd182XzEwOCIvPgo8ZmVCbGVuZCBtb2RlPSJub3JtYWwiIGluPSJTb3VyY2VHcmFwaGljIiBpbjI9ImVmZmVjdDFfZHJvcFNoYWRvd182XzEwOCIgcmVzdWx0PSJzaGFwZSIvPgo8L2ZpbHRlcj4KPC9kZWZzPgo8L3N2Zz4K';
                        break;
                    case 11:
                        categoria_icon.value = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI3IiBoZWlnaHQ9IjE0OCIgdmlld0JveD0iMCAwIDEyNyAxNDgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxnIGZpbHRlcj0idXJsKCNmaWx0ZXIwX2RfNl8xMDgpIj4KPHBhdGggZD0iTTEyMyA1OS41QzEyMyA5Mi4zNjA5IDk1IDEyMy41IDYzLjUgMTM5LjVDMzEgMTIzIDQgOTIuMzYwOSA0IDU5LjVDNCAyNi42MzkxIDMwLjYzOTEgMCA2My41IDBDOTYuMzYwOSAwIDEyMyAyNi42MzkxIDEyMyA1OS41WiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iNjMuNSIgY3k9IjU5LjUiIHI9IjQ3LjUiIGZpbGw9IiMyNzZCRjIiLz4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik04MS43MjIzIDI2LjA4MDFDODUuNTg3OCAzMC45MzggMTA0LjE2OSA1NS4wMTc0IDEwNC4zNTYgNTUuMjYwM0wxMDUgNTYuMDk0N1Y2OC44MDVDMTA1IDczLjg2MDIgMTAyLjYxMiA3OC45MzA1IDk4LjQ0ODcgODIuNzE1M0M5NC4yNzQyIDg2LjUxMDEgODguODQ1NyA4OC42IDgzLjE2MyA4OC42Qzc2LjkxNTggODguNiA3Mi4zMzU4IDg3LjEwMzMgNjkuMTYxMiA4NC4wMjM5QzY2LjM1OTEgODEuMzA1OCA2NS4zMTA5IDc3Ljk4MzEgNjQuNTQ1OCA3NS41NTY5QzY0LjM4MzEgNzUuMDQwNyA2NC4xODQgNzQuNDA5MyA2NCA3My45Mjk0QzYzLjgxNjkgNzQuNDA2NiA2My42MTkgNzUuMDMzOCA2My40NTY4IDc1LjU0OEw2My40NTQgNzUuNTU2OUw2My40NTM2IDc1LjU1ODFDNjIuNjg4MyA3Ny45ODQzIDYxLjY0MDIgODEuMzA2NSA1OC44Mzg2IDg0LjAyMzlDNTUuNjY0IDg3LjEwMzIgNTEuMDg0IDg4LjYgNDQuODM2OCA4OC42QzM5LjE1NDIgODguNiAzMy43MjU1IDg2LjUxMDEgMjkuNTUxMiA4Mi43MTUzQzI1LjM4NzkgNzguOTMwNiAyMyA3My44NjA0IDIzIDY4LjgwNTJWNTYuMDk0OEwyMy42NDM4IDU1LjI2MDNDMjMuODMxMSA1NS4wMTc2IDQyLjQxMjIgMzAuOTM4IDQ2LjI3NzkgMjYuMDhDNDguNDUyMiAyMy4zNDczIDUxLjc5MTEgMjIuMzAxMiA1NC41ODYzIDIzLjQ3NzJDNTcuMzg3NSAyNC42NTU1IDU5LjA1OTUgMjcuNzgxNiA1OS4wNTk1IDMxLjgzOTFINTMuNzExN0M1My43MTE3IDMxLjEyNDYgNTMuNjEyNCAyOS40MjEgNTIuNjkyOCAyOS4wMzQyQzUyLjA4NzEgMjguNzc4OCA1MS4wNjUxIDI5LjAzNDUgNTAuMjg0NyAzMC4wMTUzQzQ3LjUyNiAzMy40ODIgMzcuMTcxNyA0Ni44Njk4IDMxLjQ5MTIgNTQuMjIzMUg5Ni41MDg4QzkwLjgyODEgNDYuODY5OCA4MC40NzM4IDMzLjQ4MiA3Ny43MTU1IDMwLjAxNTVDNzYuOTM0NyAyOS4wMzQzIDc1LjkxMjYgMjguNzc5IDc1LjMwNzIgMjkuMDM0MkM3NC4zODc2IDI5LjQyMSA3NC4yODgzIDMxLjEyNDYgNzQuMjg4MyAzMS44MzkxSDY4Ljk0MDVDNjguOTQwNSAyNy43ODE1IDcwLjYxMjcgMjQuNjU1NSA3My40MTM3IDIzLjQ3NzJDNzYuMjA4OSAyMi4zMDIxIDc5LjU0OCAyMy4zNDczIDgxLjcyMjMgMjYuMDgwMVoiIGZpbGw9IndoaXRlIi8+CjwvZz4KPGRlZnM+CjxmaWx0ZXIgaWQ9ImZpbHRlcjBfZF82XzEwOCIgeD0iMCIgeT0iMCIgd2lkdGg9IjEyNyIgaGVpZ2h0PSIxNDcuNSIgZmlsdGVyVW5pdHM9InVzZXJTcGFjZU9uVXNlIiBjb2xvci1pbnRlcnBvbGF0aW9uLWZpbHRlcnM9InNSR0IiPgo8ZmVGbG9vZCBmbG9vZC1vcGFjaXR5PSIwIiByZXN1bHQ9IkJhY2tncm91bmRJbWFnZUZpeCIvPgo8ZmVDb2xvck1hdHJpeCBpbj0iU291cmNlQWxwaGEiIHR5cGU9Im1hdHJpeCIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAxMjcgMCIgcmVzdWx0PSJoYXJkQWxwaGEiLz4KPGZlT2Zmc2V0IGR5PSI0Ii8+CjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjIiLz4KPGZlQ29tcG9zaXRlIGluMj0iaGFyZEFscGhhIiBvcGVyYXRvcj0ib3V0Ii8+CjxmZUNvbG9yTWF0cml4IHR5cGU9Im1hdHJpeCIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwLjI1IDAiLz4KPGZlQmxlbmQgbW9kZT0ibm9ybWFsIiBpbjI9IkJhY2tncm91bmRJbWFnZUZpeCIgcmVzdWx0PSJlZmZlY3QxX2Ryb3BTaGFkb3dfNl8xMDgiLz4KPGZlQmxlbmQgbW9kZT0ibm9ybWFsIiBpbj0iU291cmNlR3JhcGhpYyIgaW4yPSJlZmZlY3QxX2Ryb3BTaGFkb3dfNl8xMDgiIHJlc3VsdD0ic2hhcGUiLz4KPC9maWx0ZXI+CjwvZGVmcz4KPC9zdmc+Cg==';
                        break;
                    case 12:
                        categoria_icon.value = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI3IiBoZWlnaHQ9IjE0OCIgdmlld0JveD0iMCAwIDEyNyAxNDgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxnIGZpbHRlcj0idXJsKCNmaWx0ZXIwX2RfNl8xMDgpIj4KPHBhdGggZD0iTTEyMyA1OS41QzEyMyA5Mi4zNjA5IDk1IDEyMy41IDYzLjUgMTM5LjVDMzEgMTIzIDQgOTIuMzYwOSA0IDU5LjVDNCAyNi42MzkxIDMwLjYzOTEgMCA2My41IDBDOTYuMzYwOSAwIDEyMyAyNi42MzkxIDEyMyA1OS41WiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iNjMuNSIgY3k9IjU5LjUiIHI9IjQ3LjUiIGZpbGw9IiMyNzZCRjIiLz4KPHBhdGggZD0iTTUyLjE4MzkgMzQuODU5MkM1Mi4xODM5IDM0Ljg1OTIgNTIuMTgzOSAyNy44ODM3IDUyLjE4MzkgMjQuOTc1N0M1Mi4xODM5IDIyLjA2OTQgNTUuNjcyIDE4IDYzLjgxMDggMThDNzEuOTQ5NCAxOCA3NS40Mzg5IDIyLjA2OTQgNzUuNDM4OSAyNC45NzU3Qzc1LjQzODkgMjcuODgzNSA3NS40Mzg5IDM0Ljg1OTIgNzUuNDM4OSAzNC44NTkyQzc1LjQzODkgMzQuODU5MiA5NC42MjI4IDQ0LjE2MTIgOTQuNjIyOCA1Mi4yOTg1Qzk0LjYyMjggNTcuNTYyOSA4Ni40ODQgNzAuOTAyNSA4Ni40ODQgNzQuOTcxOUM4Ni40ODQgNzkuMDQxMyA4Ni40ODQgOTAuMDg2NiA4Ni40ODQgOTIuOTkyOUM4Ni40ODQgOTUuODk5MiA3NC4yNzYgOTguMjI1NCA2My44MTA4IDk4LjIyNTRDNTMuMzQ3IDk4LjIyNTQgNDEuMTM4OCA5NS44OTkyIDQxLjEzODggOTIuOTkyOUM0MS4xMzg4IDkwLjA4NjYgNDEuMTM4OCA3OS4wNDE1IDQxLjEzODggNzQuOTcxOUM0MS4xMzg4IDcwLjkwMjUgMzMgNTcuNTYyOSAzMyA1Mi4yOTg1QzMzIDQ0LjE2MTIgNTIuMTgzOSAzNC44NTkyIDUyLjE4MzkgMzQuODU5MlpNODAuMDQwMyA0OC45NzY0QzgxLjU4NiA0OC45NzY0IDgyLjgzOTUgNDcuNzI0NCA4Mi44Mzk1IDQ2LjE4MDFDODIuODM5NSA0NC42MzQ0IDgxLjU4NiA0My4zODA4IDgwLjA0MDMgNDMuMzgwOEM3OC40OTc1IDQzLjM4MDggNzcuMjQ0IDQ0LjYzNDQgNzcuMjQ0IDQ2LjE4MDFDNzcuMjQ0IDQ3LjcyNDQgNzguNDk3NSA0OC45NzY0IDgwLjA0MDMgNDguOTc2NFpNNzQuMTY0NCA1OC4yMTA2Qzc1LjcxMDEgNTguMjEwNiA3Ni45NjM3IDU2Ljk1ODcgNzYuOTYzNyA1NS40MTQzQzc2Ljk2MzcgNTMuODY2OSA3NS43MTAxIDUyLjYxNDkgNzQuMTY0NCA1Mi42MTQ5QzcyLjYyMDEgNTIuNjE0OSA3MS4zNjgxIDUzLjg2NjkgNzEuMzY4MSA1NS40MTQzQzcxLjM2ODEgNTYuOTU4NyA3Mi42MjAxIDU4LjIxMDYgNzQuMTY0NCA1OC4yMTA2Wk02My44MTA4IDYzLjUyNkM2NS4zNTY1IDYzLjUyNiA2Ni42MSA2Mi4yNzQxIDY2LjYxIDYwLjcyOTdDNjYuNjEgNTkuMTgyNCA2NS4zNTY1IDU3LjkzMDMgNjMuODEwOCA1Ny45MzAzQzYyLjI2NjQgNTcuOTMwMyA2MS4wMTQ1IDU5LjE4MjQgNjEuMDE0NSA2MC43Mjk3QzYxLjAxNDUgNjIuMjc0MSA2Mi4yNjY0IDYzLjUyNiA2My44MTA4IDYzLjUyNlpNNTMuNDU3MiA1OC4yMTA2QzU1LjAwMzEgNTguMjEwNiA1Ni4yNTY2IDU2Ljk1ODcgNTYuMjU2NiA1NS40MTQzQzU2LjI1NjYgNTMuODY2OSA1NS4wMDMxIDUyLjYxNDkgNTMuNDU3MiA1Mi42MTQ5QzUxLjkxMTQgNTIuNjE0OSA1MC42NTkzIDUzLjg2NjkgNTAuNjU5MyA1NS40MTQzQzUwLjY1OTMgNTYuOTU4NyA1MS45MTE0IDU4LjIxMDYgNTMuNDU3MiA1OC4yMTA2Wk00Ny41ODEzIDQ4Ljk3NjRDNDkuMTI3MiA0OC45NzY0IDUwLjM3OTEgNDcuNzI0NCA1MC4zNzkxIDQ2LjE4MDFDNTAuMzc5MSA0NC42MzQ0IDQ5LjEyNzIgNDMuMzgwOCA0Ny41ODEzIDQzLjM4MDhDNDYuMDM1NSA0My4zODA4IDQ0Ljc4MzQgNDQuNjM0NCA0NC43ODM0IDQ2LjE4MDFDNDQuNzgzNCA0Ny43MjQ0IDQ2LjAzNTQgNDguOTc2NCA0Ny41ODEzIDQ4Ljk3NjRaIiBmaWxsPSJ3aGl0ZSIvPgo8L2c+CjxkZWZzPgo8ZmlsdGVyIGlkPSJmaWx0ZXIwX2RfNl8xMDgiIHg9IjAiIHk9IjAiIHdpZHRoPSIxMjciIGhlaWdodD0iMTQ3LjUiIGZpbHRlclVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgY29sb3ItaW50ZXJwb2xhdGlvbi1maWx0ZXJzPSJzUkdCIj4KPGZlRmxvb2QgZmxvb2Qtb3BhY2l0eT0iMCIgcmVzdWx0PSJCYWNrZ3JvdW5kSW1hZ2VGaXgiLz4KPGZlQ29sb3JNYXRyaXggaW49IlNvdXJjZUFscGhhIiB0eXBlPSJtYXRyaXgiIHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMTI3IDAiIHJlc3VsdD0iaGFyZEFscGhhIi8+CjxmZU9mZnNldCBkeT0iNCIvPgo8ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPSIyIi8+CjxmZUNvbXBvc2l0ZSBpbjI9ImhhcmRBbHBoYSIgb3BlcmF0b3I9Im91dCIvPgo8ZmVDb2xvck1hdHJpeCB0eXBlPSJtYXRyaXgiIHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMC4yNSAwIi8+CjxmZUJsZW5kIG1vZGU9Im5vcm1hbCIgaW4yPSJCYWNrZ3JvdW5kSW1hZ2VGaXgiIHJlc3VsdD0iZWZmZWN0MV9kcm9wU2hhZG93XzZfMTA4Ii8+CjxmZUJsZW5kIG1vZGU9Im5vcm1hbCIgaW49IlNvdXJjZUdyYXBoaWMiIGluMj0iZWZmZWN0MV9kcm9wU2hhZG93XzZfMTA4IiByZXN1bHQ9InNoYXBlIi8+CjwvZmlsdGVyPgo8L2RlZnM+Cjwvc3ZnPgo=';
                        break;
                    case 13:
                        categoria_icon.value = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI3IiBoZWlnaHQ9IjE0OCIgdmlld0JveD0iMCAwIDEyNyAxNDgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxnIGZpbHRlcj0idXJsKCNmaWx0ZXIwX2RfNl8xMDgpIj4KPHBhdGggZD0iTTEyMyA1OS41QzEyMyA5Mi4zNjA5IDk1IDEyMy41IDYzLjUgMTM5LjVDMzEgMTIzIDQgOTIuMzYwOSA0IDU5LjVDNCAyNi42MzkxIDMwLjYzOTEgMCA2My41IDBDOTYuMzYwOSAwIDEyMyAyNi42MzkxIDEyMyA1OS41WiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iNjMuNSIgY3k9IjU5LjUiIHI9IjQ3LjUiIGZpbGw9IiMyNzZCRjIiLz4KPHBhdGggZD0iTTc3LjA5MzUgMjAuMDAxNEM3MC4zNDMgMjAuNzgxOCA2Ni41MTAyIDI4LjE4NDUgNjYuMDIyNSAzNC42MTQ0QzY1LjIyNTEgNDAuMzMwNiA2Ny43MTk5IDQ3LjYyNDYgNzMuNzIyNCA0OC45MzlDNzguOTI0MSA0OS40MDMxIDgzLjA2MjYgNDQuNTE0OSA4NC43NjI1IDM5Ljg1MjFDODYuNzcwMSAzNC4wMTU3IDg2LjgyODggMjYuMjIxNyA4MS45NTc0IDIxLjg0OTNDODAuNjA0MyAyMC42NzY0IDc4Ljg2NjkgMTkuOTYzOSA3Ny4wOTM1IDIwLjAwMTRaTTQ5LjU1NzYgMjAuMzA3NEM0My45NDA3IDIwLjcxMzkgNDEuMDYxNyAyNy4yNDMxIDQxLjQ1MjQgMzIuNDg0MUM0MS41MDAyIDM5LjQ5MTggNDUuMzQ3NiA0Ny4zNzM1IDUyLjM2MzcgNDkuMDM3QzU3LjU5NjEgNDkuNjAzIDYxLjA4NDcgNDQuMDUyMyA2MS40MDk4IDM5LjE5ODlDNjIuMDc3NSAzMS43NzE0IDU4Ljc4NzQgMjIuNzczNiA1MS4zMzY3IDIwLjUzMTFDNTAuNzU3NiAyMC4zNzExIDUwLjE1NyAyMC4yOTE3IDQ5LjU1NzYgMjAuMzA3NFpNOTQuNjkxNiA0Mi44MTI1Qzg3LjE1NTUgNDMuMzY1IDgyLjM4OTggNTEuMzk4MyA4Mi4wNjIzIDU4LjY1NzRDODEuNjY1OCA2My4zODQ5IDg0LjcxOTIgNjkuMzMwMSA4OS44NjA2IDY5LjAwNDNDOTcuNTQ5NyA2OC4xODkxIDEwMi4xODUgNTkuNjE3MiAxMDEuOTk0IDUyLjE2OTVDMTAxLjk0NSA0Ny44ODE4IDk5LjIyODUgNDIuOTkxMiA5NC42OTE2IDQyLjgxMjVaTTI2LjA1ODQgNTIuNjExOUMyNS4zNjA2IDYwLjY1NTQgMzAuOTg3OCA2OS43NDY4IDM5LjE2MjMgNzAuMjUzM0M0NC4xMTY5IDY5LjkyMjMgNDYuNDUzMSA2NC4xNjY1IDQ1Ljg4NTMgNTkuNjEyOEM0NS40MzI4IDUyLjg5MzcgNDAuOTQxNCA0Ni4wMTMyIDM1LjEwNTggNDUuMTE0NEMyOS4yNzAzIDQ0LjIxNTUgMjUuOTY1OSA0OC4zMzkyIDI2LjA1ODQgNTIuNjExOVpNNjQuODYxIDU5LjQ3MzVDNTcuMTk3MyA1OS40OTE0IDUwLjE5MDQgNjQuNTAzNiA0Ni40NDQzIDcxLjI4NTFDNDMuMzA1NiA3Ni4zNTMgNDAuNzM5OCA4Mi4wOTAzIDQwLjI1MTcgODguMTQ1QzQwLjM1ODUgOTIuODE0NSA0NC44MTI4IDk2LjcwMDcgNDkuMjc5MiA5NS43NzA2QzU1LjY0OTkgOTQuOTQzNSA2MS4zNDI4IDkwLjUxODIgNjcuOTY3NiA5MS4zNDc0QzczLjQ3MzEgOTEuNzg3IDc4LjAxMzYgOTYuMDU3MiA4My41NzIzIDk1Ljk5NTFDODguOTY5NiA5Ni4xOTc5IDkyLjA4MzEgOTAuMDExMyA5MC4wMjQ4IDg1LjE2NTdDODcuODA5OSA3OC4yMjc2IDgzLjUxNTcgNzIuMTkzNSA3OC45MDY2IDY2Ljc1OTFDNzUuMjI5OSA2Mi43NTMzIDcwLjQxNDMgNTkuMjk2MiA2NC44NjEgNTkuNDczNVoiIGZpbGw9IndoaXRlIi8+CjwvZz4KPGRlZnM+CjxmaWx0ZXIgaWQ9ImZpbHRlcjBfZF82XzEwOCIgeD0iMCIgeT0iMCIgd2lkdGg9IjEyNyIgaGVpZ2h0PSIxNDcuNSIgZmlsdGVyVW5pdHM9InVzZXJTcGFjZU9uVXNlIiBjb2xvci1pbnRlcnBvbGF0aW9uLWZpbHRlcnM9InNSR0IiPgo8ZmVGbG9vZCBmbG9vZC1vcGFjaXR5PSIwIiByZXN1bHQ9IkJhY2tncm91bmRJbWFnZUZpeCIvPgo8ZmVDb2xvck1hdHJpeCBpbj0iU291cmNlQWxwaGEiIHR5cGU9Im1hdHJpeCIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAxMjcgMCIgcmVzdWx0PSJoYXJkQWxwaGEiLz4KPGZlT2Zmc2V0IGR5PSI0Ii8+CjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjIiLz4KPGZlQ29tcG9zaXRlIGluMj0iaGFyZEFscGhhIiBvcGVyYXRvcj0ib3V0Ii8+CjxmZUNvbG9yTWF0cml4IHR5cGU9Im1hdHJpeCIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwLjI1IDAiLz4KPGZlQmxlbmQgbW9kZT0ibm9ybWFsIiBpbjI9IkJhY2tncm91bmRJbWFnZUZpeCIgcmVzdWx0PSJlZmZlY3QxX2Ryb3BTaGFkb3dfNl8xMDgiLz4KPGZlQmxlbmQgbW9kZT0ibm9ybWFsIiBpbj0iU291cmNlR3JhcGhpYyIgaW4yPSJlZmZlY3QxX2Ryb3BTaGFkb3dfNl8xMDgiIHJlc3VsdD0ic2hhcGUiLz4KPC9maWx0ZXI+CjwvZGVmcz4KPC9zdmc+Cg==';
                        break;
                    default:
                        categoria_icon.value = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI3IiBoZWlnaHQ9IjE0OCIgdmlld0JveD0iMCAwIDEyNyAxNDgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxnIGZpbHRlcj0idXJsKCNmaWx0ZXIwX2RfNl8xMDgpIj4KPHBhdGggZD0iTTEyMyA1OS41QzEyMyA5Mi4zNjA5IDk1IDEyMy41IDYzLjUgMTM5LjVDMzEgMTIzIDQgOTIuMzYwOSA0IDU5LjVDNCAyNi42MzkxIDMwLjYzOTEgMCA2My41IDBDOTYuMzYwOSAwIDEyMyAyNi42MzkxIDEyMyA1OS41WiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iNjMuNSIgY3k9IjU5LjUiIHI9IjQ3LjUiIGZpbGw9IiMyNzZCRjIiLz4KPHBhdGggZD0iTTkwLjg1MzUgNjguNzM2QzkzLjMwMTEgNjguNzM2IDk1LjM4MTYgNjcuODg2NyA5Ny4wOTQ5IDY2LjE4OEM5OC44MDgyIDY0LjQ4OTMgOTkuNjY0OSA2Mi40MjY3IDk5LjY2NDkgNjBDOTkuNjY0OSA1Ny41NzMzIDk4LjgwODIgNTUuNTEwNyA5Ny4wOTQ5IDUzLjgxMkM5NS4zODE2IDUyLjExMzMgOTMuMzAxMSA1MS4yNjQgOTAuODUzNSA1MS4yNjRDODguNDA2IDUxLjI2NCA4Ni4zMjU1IDUyLjExMzMgODQuNjEyMiA1My44MTJDODIuODk4OSA1NS41MTA3IDgyLjA0MjIgNTcuNTczMyA4Mi4wNDIyIDYwQzgyLjA0MjIgNjIuNDI2NyA4Mi44OTg5IDY0LjQ4OTMgODQuNjEyMiA2Ni4xODhDODYuMzI1NSA2Ny44ODY3IDg4LjQwNiA2OC43MzYgOTAuODUzNSA2OC43MzZaTTY0IDY4LjczNkM2Ni40NDc2IDY4LjczNiA2OC41MjgxIDY3Ljg4NjcgNzAuMjQxNCA2Ni4xODhDNzEuOTU0NyA2NC40ODkzIDcyLjgxMTMgNjIuNDI2NyA3Mi44MTEzIDYwQzcyLjgxMTMgNTcuNTczMyA3MS45NTQ3IDU1LjUxMDcgNzAuMjQxNCA1My44MTJDNjguNTI4MSA1Mi4xMTMzIDY2LjQ2NTEgNTEuMjY0IDY0LjA1MjUgNTEuMjY0QzYxLjYzOTkgNTEuMjY0IDU5LjU1OTQgNTIuMTEzMyA1Ny44MTExIDUzLjgxMkM1Ni4wNjI5IDU1LjUxMDcgNTUuMTg4NyA1Ny41NzMzIDU1LjE4ODcgNjBDNTUuMTg4NyA2Mi40MjY3IDU2LjA2MjkgNjQuNDg5MyA1Ny44MTExIDY2LjE4OEM1OS41NTk0IDY3Ljg4NjcgNjEuNjU3MyA2OC43MzYgNjQuMTA0OSA2OC43MzZINjRaTTM3LjE0NjUgNjguNzM2QzM5LjU5NDEgNjguNzM2IDQxLjY3NDUgNjcuODg2NyA0My4zODc5IDY2LjE4OEM0NS4xMDEyIDY0LjQ4OTMgNDUuOTU3OCA2Mi40MjY3IDQ1Ljk1NzggNjBDNDUuOTU3OCA1Ny41NzMzIDQ1LjEwMTIgNTUuNTEwNyA0My4zODc5IDUzLjgxMkM0MS42NzQ1IDUyLjExMzMgMzkuNTk0MSA1MS4yNjQgMzcuMTQ2NSA1MS4yNjRDMzQuNjk4OSA1MS4yNjQgMzIuNjE4NSA1Mi4xMTMzIDMwLjkwNTIgNTMuODEyQzI5LjE5MTkgNTUuNTEwNyAyOC4zMzUyIDU3LjU3MzMgMjguMzM1MiA2MEMyOC4zMzUyIDYyLjQyNjcgMjkuMTkxOSA2NC40ODkzIDMwLjkwNTIgNjYuMTg4QzMyLjYxODUgNjcuODg2NyAzNC42OTg5IDY4LjczNiAzNy4xNDY1IDY4LjczNloiIGZpbGw9IndoaXRlIi8+CjwvZz4KPGRlZnM+CjxmaWx0ZXIgaWQ9ImZpbHRlcjBfZF82XzEwOCIgeD0iMCIgeT0iMCIgd2lkdGg9IjEyNyIgaGVpZ2h0PSIxNDcuNSIgZmlsdGVyVW5pdHM9InVzZXJTcGFjZU9uVXNlIiBjb2xvci1pbnRlcnBvbGF0aW9uLWZpbHRlcnM9InNSR0IiPgo8ZmVGbG9vZCBmbG9vZC1vcGFjaXR5PSIwIiByZXN1bHQ9IkJhY2tncm91bmRJbWFnZUZpeCIvPgo8ZmVDb2xvck1hdHJpeCBpbj0iU291cmNlQWxwaGEiIHR5cGU9Im1hdHJpeCIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAxMjcgMCIgcmVzdWx0PSJoYXJkQWxwaGEiLz4KPGZlT2Zmc2V0IGR5PSI0Ii8+CjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjIiLz4KPGZlQ29tcG9zaXRlIGluMj0iaGFyZEFscGhhIiBvcGVyYXRvcj0ib3V0Ii8+CjxmZUNvbG9yTWF0cml4IHR5cGU9Im1hdHJpeCIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwLjI1IDAiLz4KPGZlQmxlbmQgbW9kZT0ibm9ybWFsIiBpbjI9IkJhY2tncm91bmRJbWFnZUZpeCIgcmVzdWx0PSJlZmZlY3QxX2Ryb3BTaGFkb3dfNl8xMDgiLz4KPGZlQmxlbmQgbW9kZT0ibm9ybWFsIiBpbj0iU291cmNlR3JhcGhpYyIgaW4yPSJlZmZlY3QxX2Ryb3BTaGFkb3dfNl8xMDgiIHJlc3VsdD0ic2hhcGUiLz4KPC9maWx0ZXI+CjwvZGVmcz4KPC9zdmc+Cg==';
                        break;
                }

                marker.setStyle(
                    new Style({
                        image: new Icon({
                            src: categoria_icon.value,
                            scale: 0.3
                        }),
                        text: new Text({
                            text: comercio.nombre, // Nombre del comercio
                            font: "bold 14px Lato",
                            fill: new Fill({ color: "#276bf2" }), // Color azul
                            stroke: new Stroke({ color: "#fff", width: 3 }), // Contorno blanco
                            offsetY: 0, // Eleva el texto sobre el marcador
                            offsetX: -25,
                            textAlign: "right", // Alineación horizontal
                            textBaseline: "middle",
                        })
                    })
                );

                vectorSource.value.addFeature(marker);
            }
        });
    } catch (error) {
        console.error("Error obteniendo ubicaciones:", error);
    }
};

const buscarPorCodigoPostal = async () => {
    if (!codigoPostal.value) {
        alert("Introduce un código postal.");
        return;
    }

    try {
        const response = await fetch(`${API_URL}?postalcode=${codigoPostal.value}&country=ES&format=json`);
        const data = await response.json();

        if (data.length > 0) {
            console.log("ENTRA")
            const ubicacion = data[0];
            const lat = parseFloat(ubicacion.lat);
            const lon = parseFloat(ubicacion.lon);
            puebloSeleccionado.value = {
                name: ubicacion.display_name,
                lat,
                lon
            };

            agregarMarcador(lon, lat, puebloSeleccionado.value.name);

            map.value.getView().animate({
                center: fromLonLat([lon, lat]),
                zoom: 14,
                duration: 1000
            });
        } else {
            alert("No se encontró la ubicación.");
        }
    } catch (error) {
        console.error("Error en la búsqueda:", error);
        alert("Error al buscar el código postal.");
    }
};

const agregarMarcador = (lon, lat, name) => {
    const marker = new Feature({
        geometry: new Point(fromLonLat([lon, lat])),
        name: name
    });

    // marker.setStyle(
    //     new Style({
    //         image: new Icon({
    //             src: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI3IiBoZWlnaHQ9IjE0OCIgdmlld0JveD0iMCAwIDEyNyAxNDgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxnIGZpbHRlcj0idXJsKCNmaWx0ZXIwX2RfOV8zOSkiPgo8cGF0aCBkPSJNMTIzIDU5LjVDMTIzIDkyLjM2MDkgOTUgMTIzLjUgNjMuNSAxMzkuNUMzMSAxMjMgNCA5Mi4zNjA5IDQgNTkuNUM0IDI2LjYzOTEgMzAuNjM5MSAwIDYzLjUgMEM5Ni4zNjA5IDAgMTIzIDI2LjYzOTEgMTIzIDU5LjVaIiBmaWxsPSIjMjc2QkYyIi8+CjxjaXJjbGUgY3g9IjYzLjUiIGN5PSI1OS41IiByPSIyOC41IiBmaWxsPSJ3aGl0ZSIvPgo8L2c+CjxkZWZzPgo8ZmlsdGVyIGlkPSJmaWx0ZXIwX2RfOV8zOSIgeD0iMCIgeT0iMCIgd2lkdGg9IjEyNyIgaGVpZ2h0PSIxNDcuNSIgZmlsdGVyVW5pdHM9InVzZXJTcGFjZU9uVXNlIiBjb2xvci1pbnRlcnBvbGF0aW9uLWZpbHRlcnM9InNSR0IiPgo8ZmVGbG9vZCBmbG9vZC1vcGFjaXR5PSIwIiByZXN1bHQ9IkJhY2tncm91bmRJbWFnZUZpeCIvPgo8ZmVDb2xvck1hdHJpeCBpbj0iU291cmNlQWxwaGEiIHR5cGU9Im1hdHJpeCIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAxMjcgMCIgcmVzdWx0PSJoYXJkQWxwaGEiLz4KPGZlT2Zmc2V0IGR5PSI0Ii8+CjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjIiLz4KPGZlQ29tcG9zaXRlIGluMj0iaGFyZEFscGhhIiBvcGVyYXRvcj0ib3V0Ii8+CjxmZUNvbG9yTWF0cml4IHR5cGU9Im1hdHJpeCIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwLjI1IDAiLz4KPGZlQmxlbmQgbW9kZT0ibm9ybWFsIiBpbjI9IkJhY2tncm91bmRJbWFnZUZpeCIgcmVzdWx0PSJlZmZlY3QxX2Ryb3BTaGFkb3dfOV8zOSIvPgo8ZmVCbGVuZCBtb2RlPSJub3JtYWwiIGluPSJTb3VyY2VHcmFwaGljIiBpbjI9ImVmZmVjdDFfZHJvcFNoYWRvd185XzM5IiByZXN1bHQ9InNoYXBlIi8+CjwvZmlsdGVyPgo8L2RlZnM+Cjwvc3ZnPgo=',
    //             scale: 0.3
    //         }),
    //         text: new Text({
    //             text: comercio.nombre, // Nombre del comercio
    //             font: "bold 14px Lato",
    //             fill: new Fill({ color: "#276bf2" }), // Color azul
    //             stroke: new Stroke({ color: "#fff", width: 3 }), // Contorno blanco
    //             offsetY: 0, // Eleva el texto sobre el marcador
    //             offsetX: -25,
    //             textAlign: "right", // Alineación horizontal
    //             textBaseline: "middle",
    //         })
    //     })
    // );

    vectorSource.value.addFeature(marker);
};

const getLocation = () => {
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(
            (position) => {
                const lat = position.coords.latitude;
                const lon = position.coords.longitude;
                location.value = `Lat: ${lat}, Lng: ${lon}`;

                const lonLat = fromLonLat([lon, lat]);

                map.value.getView().animate({
                    center: lonLat,
                    zoom: 16,
                    duration: 1000
                });

                vectorSource.value.getFeatures().forEach(feature => {
                    if (feature.get('userLocation')) {
                        vectorSource.value.removeFeature(feature);
                    }
                });
            },
            (error) => {
                location.value = `Error: ${error.message}`;
            },
            {
                enableHighAccuracy: true,
                timeout: 10000,
                maximumAge: 0
            }
        );
    } else {
        location.value = 'La geolocalización no es compatible con este navegador.';
    }
};

const cerrarPopup = () => {
    showPopup.value = false;
};
</script>

<style scoped>
@import '../assets/mapa.css';
</style>
